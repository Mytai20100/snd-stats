/**
 * snd-stats - GitHub Stats API v2.1
 * Clean, fast, production-ready API for GitHub stats with SVG badges
 * Author: mytai20100
 * Repository: github.com/mytai20100/snd-stats
 */

import express, { Request, Response, NextFunction } from 'express';

const app = express();
app.use(express.json());

// Environment configuration
const PORT = process.env.PORT || 3444;
const GITHUB_TOKEN = process.env.GITHUB_TOKEN || '';
const API_KEY = process.env.API_KEY || 'default-secret-key';
const CACHE_TTL = parseInt(process.env.CACHE_TTL_SECONDS || '300') * 1000;
const TWITTER_BEARER = process.env.TWITTER_BEARER_TOKEN || '';
const YOUTUBE_API_KEY = process.env.YOUTUBE_API_KEY || '';

// Types
interface CacheEntry {
  data: any;
  expires: number;
}

interface RateLimitEntry {
  count: number;
  resetAt: number;
}

interface BadgeOptions {
  width?: string;
  height?: string;
  bg_color?: string;
  text_color?: string;
  accent_color?: string;
  label_color?: string;
  value_color?: string;
  show_frameworks?: string;
  show_chart?: string;
  sketchy?: string;
  chart_type?: string;
  top_langs?: string;
  font_size?: string;
  animation?: string;
  border_radius?: string;
  show_values?: string;
}

interface CustomBadgeOptions extends BadgeOptions {
  icon?: string;
  label?: string;
  value?: string;
  icon_color?: string;
}

interface DiscordServer {
  serverName: string;
  members: number;
}
interface BadgeOptions {
  font_family?: string; // 'Segoe UI', 'Arial', 'Roboto', 'Monospace'
  font_weight?: string; // '400', '600', '700'
  text_effect?: string; // 'none', 'shadow', 'glow', 'fade', 'slide'
}

// In-memory stores
const cache = new Map<string, CacheEntry>();
const discordServers = new Map<string, DiscordServer>();
const requestCounts = new Map<string, RateLimitEntry>();

// Rate limiting config
const RATE_LIMIT_WINDOW = 60000;
const RATE_LIMIT_MAX = 60;

// Extended icon mappings
const languageIcons: Record<string, string> = {
  JavaScript: '<path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z" fill="#F7DF1E"/>',
  TypeScript: '<path d="M1.125 0C.502 0 0 .502 0 1.125v21.75C0 23.498.502 24 1.125 24h21.75c.623 0 1.125-.502 1.125-1.125V1.125C24 .502 23.498 0 22.875 0zm17.363 9.75c.612 0 1.154.037 1.627.111a6.38 6.38 0 0 1 1.306.34v2.458a3.95 3.95 0 0 0-.643-.361 5.093 5.093 0 0 0-.717-.26 5.453 5.453 0 0 0-1.426-.2c-.3 0-.573.028-.819.086a2.1 2.1 0 0 0-.623.242c-.17.104-.3.229-.393.374a.888.888 0 0 0-.14.49c0 .196.053.373.156.529.104.156.252.304.443.444s.423.276.696.41c.273.135.582.274.926.416.47.197.892.407 1.266.628.374.222.695.473.963.753.268.279.472.598.614.957.142.359.214.776.214 1.253 0 .657-.125 1.21-.373 1.656a3.033 3.033 0 0 1-1.012 1.085 4.38 4.38 0 0 1-1.487.596c-.566.12-1.163.18-1.79.18a9.916 9.916 0 0 1-1.84-.164 5.544 5.544 0 0 1-1.512-.493v-2.63a5.033 5.033 0 0 0 3.237 1.2c.333 0 .624-.03.872-.09.249-.06.456-.144.623-.25.166-.108.29-.234.373-.38a1.023 1.023 0 0 0-.074-1.089 2.12 2.12 0 0 0-.537-.5 5.597 5.597 0 0 0-.807-.444 27.72 27.72 0 0 0-1.007-.436c-.918-.383-1.602-.852-2.053-1.405-.45-.553-.676-1.222-.676-2.005 0-.614.123-1.141.369-1.582.246-.441.58-.804 1.004-1.089a4.494 4.494 0 0 1 1.47-.629 7.536 7.536 0 0 1 1.77-.201zm-15.113.188h9.563v2.166H9.506v9.646H6.789v-9.646H3.375z" fill="#3178C6"/>',
  Python: '<path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z" fill="#3776AB"/>',
  Java: '<path d="M8.851 18.56s-.917.534.653.714c1.902.218 2.874.187 4.969-.211 0 0 .552.346 1.321.646-4.699 2.013-10.633-.118-6.943-1.149M8.276 15.933s-1.028.761.542.924c2.032.209 3.636.227 6.413-.308 0 0 .384.389.987.602-5.679 1.661-12.007.13-7.942-1.218M13.116 11.475c1.158 1.333-.304 2.533-.304 2.533s2.939-1.518 1.589-3.418c-1.261-1.772-2.228-2.652 3.007-5.688 0-.001-8.216 2.051-4.292 6.573M19.33 20.504s.679.559-.747.991c-2.712.822-11.288 1.069-13.669.033-.856-.373.75-.89 1.254-.998.527-.114.828-.093.828-.093-.953-.671-6.156 1.317-2.643 1.887 9.58 1.553 17.462-.7 14.977-1.82M9.292 13.21s-4.362 1.036-1.544 1.412c1.189.159 3.561.123 5.77-.062 1.806-.152 3.618-.477 3.618-.477s-.637.272-1.098.587c-4.429 1.165-12.986.623-10.522-.568 2.082-1.006 3.776-.892 3.776-.892M17.116 17.584c4.503-2.34 2.421-4.589.968-4.285-.355.074-.515.138-.515.138s.132-.207.385-.297c2.875-1.011 5.086 2.981-.928 4.562 0-.001.07-.062.09-.118M14.401 0s2.494 2.494-2.365 6.33c-3.896 3.077-.888 4.832-.001 6.836-2.274-2.053-3.943-3.858-2.824-5.539 1.644-2.469 6.197-3.665 5.19-7.627M9.734 23.924c4.322.277 10.959-.153 11.116-2.198 0 0-.302.775-3.572 1.391-3.688.694-8.239.613-10.937.168 0-.001.553.457 3.393.639" fill="#EA2D2E"/>',
  Rust: '<path d="M23.836 11.17l-1.957-.281a.883.883 0 0 1-.248-.085 9.831 9.831 0 0 0-.803-1.944.842.842 0 0 1-.133-.267l.761-1.785a.427.427 0 0 0-.06-.444L19.504 4.47a.427.427 0 0 0-.443-.06l-1.785.761a.845.845 0 0 1-.267.133 9.831 9.831 0 0 0-1.944-.803.883.883 0 0 1-.085-.248L14.699 2.3a.427.427 0 0 0-.42-.3h-2.558a.427.427 0 0 0-.42.3l-.281 1.957a.883.883 0 0 1-.085.248 9.831 9.831 0 0 0-1.944.803.845.845 0 0 1-.267.133l-1.785-.761a.427.427 0 0 0-.444.06L4.603 6.632a.427.427 0 0 0-.06.443l.761 1.785a.845.845 0 0 1 .133.267 9.831 9.831 0 0 0-.803 1.944.883.883 0 0 1-.248.085L2.429 11.44a.427.427 0 0 0-.3.42v2.558c0 .204.145.381.344.42l1.957.281a.883.883 0 0 1 .248.085c.212.678.482 1.326.803 1.944a.842.842 0 0 1 .133.267l-.761 1.785a.427.427 0 0 0 .06.443l1.892 1.893a.427.427 0 0 0 .443.06l1.785-.761a.845.845 0 0 1 .267-.133 9.831 9.831 0 0 0 1.944.803.883.883 0 0 1 .085.248l.281 1.957c.039.199.216.344.42.344h2.558a.427.427 0 0 0 .42-.344l.281-1.957a.883.883 0 0 1 .085-.248 9.831 9.831 0 0 0 1.944-.803.845.845 0 0 1 .267-.133l1.785.761a.427.427 0 0 0 .443-.06l1.893-1.892a.427.427 0 0 0 .06-.443l-.761-1.785a.845.845 0 0 1-.133-.267 9.831 9.831 0 0 0 .803-1.944.883.883 0 0 1 .248-.085l1.957-.281a.427.427 0 0 0 .344-.42V11.59a.427.427 0 0 0-.344-.42zM19.35 12.47a6.85 6.85 0 1 1-13.7 0 6.85 6.85 0 0 1 13.7 0z" fill="#CE422B"/>',
  C: '<rect x="5" y="5" width="14" height="14" fill="#555555"/>',
  'C++': '<path d="M8 8h8v8H8z M10 10h4v4h-4z" fill="#f34b7d"/>',
  'C#': '<circle cx="12" cy="12" r="10" fill="#178600"/>',
  PHP: '<path d="M7.01 10.207h-.944l-.515 2.648h.838c.556 0 .97-.105 1.242-.314.272-.21.455-.559.55-1.049.092-.47.05-.802-.124-.995-.175-.193-.523-.29-1.047-.29zM12 5.688C5.373 5.688 0 8.514 0 12s5.373 6.313 12 6.313S24 15.486 24 12c0-3.486-5.373-6.312-12-6.312zm-3.26 7.451c-.261.25-.575.438-.917.551-.336.108-.765.164-1.285.164H5.357l-.327 1.681H3.652l1.23-6.326h2.65c.797 0 1.378.209 1.744.628.366.418.476 1.002.33 1.752a2.836 2.836 0 0 1-.305.847c-.143.255-.33.49-.561.703zm4.024.715l.543-2.799c.063-.318.039-.536-.068-.651-.107-.116-.336-.174-.687-.174H11.46l-.704 3.625H9.388l1.23-6.327h1.367l-.327 1.682h1.218c.767 0 1.295.134 1.586.401s.378.7.263 1.299l-.572 2.944h-1.389zm7.597-2.265a2.782 2.782 0 0 1-.305.847c-.143.255-.33.49-.561.703a2.44 2.44 0 0 1-.917.551c-.336.108-.765.164-1.286.164h-1.18l-.327 1.682h-1.378l1.23-6.326h2.649c.797 0 1.378.209 1.744.628.366.417.477 1.001.331 1.751zM17.766 10.207h-.943l-.516 2.648h.838c.557 0 .971-.105 1.242-.314.272-.21.455-.559.551-1.049.092-.47.049-.802-.125-.995s-.524-.29-1.047-.29z" fill="#777BB4"/>',
  Ruby: '<polygon points="12,4 20,12 12,20 4,12" fill="#701516"/>',
  Swift: '<path d="M7.508 0c-.287 0-.573 0-.86.002-.241.002-.483.003-.724.01-.132.003-.263.009-.395.015A9.154 9.154 0 0 0 4.348.15 5.492 5.492 0 0 0 2.85.645 5.04 5.04 0 0 0 .645 2.848c-.245.48-.407.973-.495 1.497a9.081 9.081 0 0 0-.123 1.18 30.993 30.993 0 0 0-.025 1.119C0 6.889 0 7.133 0 7.508v8.984c0 .375 0 .618.002.863.002.241.003.483.01.724.007.132.013.263.019.395.033.401.087.794.15 1.18.088.524.25 1.017.495 1.497a5.038 5.038 0 0 0 2.205 2.205c.48.245.973.407 1.497.495.387.063.779.116 1.18.15.132.006.263.012.395.018.241.007.483.009.724.01.245.003.488.003.863.003h8.984c.375 0 .618 0 .863-.002.241-.002.483-.003.724-.01.132-.003.263-.009.395-.015.401-.033.794-.087 1.18-.15a5.31 5.31 0 0 0 1.497-.495 5.04 5.04 0 0 0 2.205-2.205c.245-.48.407-.973.495-1.497.063-.387.116-.779.15-1.18.006-.132.012-.263.018-.395.007-.241.009-.483.01-.724.003-.245.003-.488.003-.863V7.508c0-.287 0-.573-.002-.86-.002-.241-.003-.483-.01-.724a9.154 9.154 0 0 0-.018-.395 5.31 5.31 0 0 0-.15-1.18 5.492 5.492 0 0 0-.495-1.497 5.04 5.04 0 0 0-2.205-2.205 5.492 5.492 0 0 0-1.497-.495A9.154 9.154 0 0 0 18.104.027a30.993 30.993 0 0 0-.724-.01C17.135 0 16.891 0 16.516 0H7.508zM6.931 19.117c-5.577-4.155-7.463-9.77-6.014-13.813.801.84 1.609 1.862 2.391 3.043a30.53 30.53 0 0 1 1.422 2.425 30.533 30.533 0 0 0 3.842 5.446c.017.018.036.037.055.056 1.065 1.04 2.216 1.986 3.454 2.828-1.663-.105-3.326-.535-4.95-1.308-.093-.045-.187-.087-.28-.133-.093-.047-.187-.095-.28-.144-.282-.151-.561-.307-.84-.464-.28-.157-.559-.318-.84-.487-.28-.169-.56-.342-.84-.522-.28-.179-.559-.363-.84-.554a23.88 23.88 0 0 1-.28-.2zm10.165 1.69c-1.035.412-2.11.718-3.223.918.897-.764 1.753-1.602 2.559-2.51a30.524 30.524 0 0 0 3.842-5.447 30.567 30.567 0 0 1 1.422-2.425c.782-1.18 1.59-2.202 2.391-3.043 1.449 4.042-.437 9.658-6.014 13.813-.28.21-.561.414-.84.606-.28.191-.56.376-.84.553-.28.177-.559.347-.84.507-.28.161-.559.314-.84.458a23.88 23.88 0 0 1-.28.145c-.093.046-.187.088-.28.133-.747.356-1.515.65-2.304.882.948-.324 1.852-.726 2.714-1.196.28-.153.559-.311.84-.472.28-.161.56-.327.84-.498z" fill="#F05138"/>',
  Kotlin: '<path d="M0 24L12 12 0 0h12L24 12 12 24H0z" fill="#7F52FF"/>',
  Lua: '<circle cx="12" cy="12" r="10" fill="#000080"/>',
  Shell: '<path d="M21.038 4.9l-7.577 18.183a1.262 1.262 0 0 1-2.335 0L3.549 4.9a1.262 1.262 0 0 1 1.168-1.77h15.154c.914 0 1.555.922 1.167 1.77zM12 8.5l-3.5 7h7L12 8.5z" fill="#89E051"/>',
  HTML: '<path d="M1.5 0h21l-1.91 21.563L11.977 24l-8.565-2.438L1.5 0zm7.031 9.75l-.232-2.718 10.059.003.23-2.622L5.412 4.41l.698 8.01h9.126l-.326 3.426-2.91.804-2.955-.81-.188-2.11H6.248l.33 4.171L12 19.351l5.379-1.443.744-8.157H8.531z" fill="#E34F26"/>',
  CSS: '<path d="M1.5 0h21l-1.91 21.563L11.977 24l-8.564-2.438L1.5 0zm17.09 4.413L5.41 4.41l.213 2.622 10.125.002-.255 2.716h-6.64l.24 2.573h6.182l-.366 3.523-2.91.804-2.956-.81-.188-2.11h-2.61l.29 3.855L12 19.288l5.373-1.53L18.59 4.414z" fill="#1572B6"/>',
  SCSS: '<path d="M4 4l2 16 6 2 6-2 2-16z" fill="#cc6699"/>',
  Sass: '<path d="M4 4l2 16 6 2 6-2 2-16z" fill="#cc6699"/>',
  R: '<circle cx="12" cy="12" r="10" fill="#198CE7"/>',
  Dart: '<path d="M6.09 17.909L0 23.998V4.228l6.09 6.09v7.591zM12 24l-5.91-6.091L12 11.818 17.91 17.909 12 24zm5.91-6.091L24 24V4.227l-6.09 6.091v7.591zM12 0L0 4.228 5.909 10.318 12 4.227l6.091 6.091L24 4.228 12 0z" fill="#0175C2"/>',
  Scala: '<rect x="4" y="4" width="16" height="16" fill="#c22d40" rx="2"/>',
  Perl: '<circle cx="12" cy="12" r="10" fill="#0298c3"/>',
  Haskell: '<path d="M4 8l4 4-4 4M10 8l4 4-4 4M16 12h6" stroke="#5e5086" fill="none" stroke-width="2"/>',
  Elixir: '<path d="M12 2l10 10-10 10-10-10z" fill="#6e4a7e"/>',
  Clojure: '<circle cx="12" cy="12" r="10" fill="#db5855"/>',
  Erlang: '<rect x="4" y="4" width="16" height="16" fill="#B83998" rx="2"/>',
  Objective_C: '<circle cx="12" cy="12" r="10" fill="#438eff"/>',
  'Objective-C': '<circle cx="12" cy="12" r="10" fill="#438eff"/>',
  MATLAB: '<rect x="4" y="4" width="16" height="16" fill="#e16737" rx="2"/>',
  Solidity: '<path d="M12 2l8 6v8l-8 6-8-6V8z" fill="#AA6746"/>',
  Assembly: '<rect x="4" y="4" width="16" height="16" fill="#6E4C13"/>',
  Groovy: '<path d="M4 4l8 8-8 8M12 4l8 8-8 8" stroke="#4298b8" fill="none" stroke-width="2"/>',
  Markdown: '<path d="M4 4h16v16H4z M8 10v4M12 8v8M16 10v4" stroke="#083fa1" fill="none" stroke-width="1.5"/>',
};

const frameworkIcons: Record<string, string> = {
  React: '<circle cx="12" cy="12" r="2.5" fill="#61DAFB"/><ellipse cx="12" cy="12" rx="11" ry="4.2" stroke="#61DAFB" stroke-width="1" fill="none"/><ellipse cx="12" cy="12" rx="11" ry="4.2" stroke="#61DAFB" stroke-width="1" fill="none" transform="rotate(60 12 12)"/><ellipse cx="12" cy="12" rx="11" ry="4.2" stroke="#61DAFB" stroke-width="1" fill="none" transform="rotate(120 12 12)"/>',
  Vue: '<path d="M2 3h3.5L12 15l6.5-12H22L12 21 2 3zm4.5 0h3L12 7.58 14.5 3h3L12 13.08 6.5 3z" fill="#42B883"/><path d="M2 3l10 18L22 3h-3.5L12 13.08 5.5 3z" fill="#35495E"/>',
  Angular: '<path d="M12 2L3 6l1.5 13L12 22l7.5-3L21 6l-9-4zm0 2.18l6.86 15.64h-2.02l-1.71-4.28H8.87l-1.71 4.28H5.14L12 4.18zm0 3.42L9.43 12.6h5.14L12 7.6z" fill="#DD0031"/>',
  Next: '<rect x="5" y="5" width="14" height="14" rx="2" fill="#000"/><path d="M9 9h6v6H9z" fill="#fff"/>',
  'Next.js': '<path fill="#000" d="M11.214.006c-.052.005-.216.022-.364.033-3.408.307-6.601 2.146-8.623 4.973a11.88 11.88 0 0 0-2.118 5.243c-.096.66-.108.854-.108 1.748s.012 1.088.108 1.748c.652 4.506 3.86 8.292 8.209 9.695.779.25 1.6.422 2.534.525.363.04 1.935.04 2.299 0 1.611-.178 2.977-.577 4.323-1.264.207-.106.247-.134.219-.158l-1.955-2.62-1.919-2.592-2.404-3.558a339 339 0 0 0-2.421-3.556c-.009-.002-.018 1.579-.023 3.51-.007 3.38-.01 3.515-.052 3.595a.426.426 0 0 1-.206.214c-.075.037-.14.044-.495.044H7.81l-.108-.068a.44.44 0 0 1-.157-.171l-.05-.106.006-4.703.007-4.705.072-.092a.65.65 0 0 1 .174-.143c.096-.047.134-.051.54-.051.478 0 .558.018.682.154.035.038 1.337 1.999 2.895 4.361l4.735 7.17 1.9 2.879.096-.063a12.32 12.32 0 0 0 2.466-2.163 11.94 11.94 0 0 0 2.824-6.134c.096-.66.108-.854.108-1.748s-.012-1.088-.108-1.748C23.24 6.59 20.033 2.804 15.683 1.4a12.6 12.6 0 0 0-2.499-.523 33 33 0 0 0-1.97-.03zm4.069 7.217c.347 0 .408.005.486.047a.473.473 0 0 1 .237.277c.018.06.023 1.365.018 4.304l-.006 4.218-.744-1.14-.746-1.14v-3.066c0-1.982.01-3.097.023-3.15a.478.478 0 0 1 .233-.296c.096-.05.13-.054.5-.054z"/>',
  Nuxt: '<path d="M12 5l7 12H5l7-12z" fill="#00DC82"/><path d="M12 8l4.5 8h-9L12 8z" fill="#108775"/>',
  'Nuxt.js': '<path d="M12 4l8 14H4z" fill="#00DC82"/>',
  Svelte: '<path d="M10.354 21.125a4.44 4.44 0 0 1-4.765-1.767 4.109 4.109 0 0 1-.703-3.107 3.898 3.898 0 0 1 .134-.522l.105-.321.287.21a7.21 7.21 0 0 0 2.186 1.092l.208.063-.02.208a1.253 1.253 0 0 0 .226.83c.214.326.554.543.944.602a1.233 1.233 0 0 0 .946-.197l6.945-4.006a1.265 1.265 0 0 0 .553-.667 1.28 1.28 0 0 0-.072-.95 1.225 1.225 0 0 0-.944-.602 1.233 1.233 0 0 0-.946.197l-2.707 1.563c-.604.348-1.283.517-1.969.491a4.44 4.44 0 0 1-3.813-2.27 4.109 4.109 0 0 1-.703-3.107 3.942 3.942 0 0 1 1.665-2.436l6.945-4.006a4.37 4.37 0 0 1 2.088-.572 4.44 4.44 0 0 1 4.765 1.767 4.109 4.109 0 0 1 .703 3.107 3.942 3.942 0 0 1-.134.522l-.105.321-.287-.21a7.21 7.21 0 0 0-2.186-1.092l-.208-.063.02-.208a1.253 1.253 0 0 0-.226-.83 1.225 1.225 0 0 0-.944-.602 1.233 1.233 0 0 0-.946.197L8.6 7.717a1.265 1.265 0 0 0-.553.667c-.103.331-.08.685.072.95a1.225 1.225 0 0 0 .944.602c.33.05.665-.02.946-.197l2.707-1.563c.604-.348 1.283-.517 1.969-.491a4.44 4.44 0 0 1 3.813 2.27 4.109 4.109 0 0 1 .703 3.107 3.942 3.942 0 0 1-1.665 2.436l-6.945 4.006a4.37 4.37 0 0 1-2.088.572z" fill="#FF3E00"/>',
  Django: '<path d="M11.146 0h3.924v18.166c-2.013.382-3.491.535-5.096.535-4.791 0-7.288-2.166-7.288-6.32 0-4.002 2.65-6.6 6.753-6.6.637 0 1.121.05 1.707.203zm0 9.143a3.894 3.894 0 0 0-1.325-.204c-1.988 0-3.134 1.223-3.134 3.365 0 2.09 1.096 3.236 3.109 3.236.433 0 .79-.025 1.35-.102V9.142zM21.314 6.06v9.097c0 3.134-.229 4.638-.917 5.937-.637 1.249-1.478 2.039-3.211 2.905l-3.644-1.733c1.733-.815 2.574-1.53 3.109-2.625.561-1.121.739-2.421.739-5.835V6.059h3.924zM17.39.021h3.924v4.026H17.39z" fill="#092E20"/>',
  Flask: '<path d="M12 0L2.524 3.855v3.894l9.476 15.36 9.476-15.36V3.855zm0 2.292l7.262 2.782v2.89L12 17.988 4.738 7.965v-2.89zM10.5 7.875a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z" fill="#000"/>',
  Express: '<path d="M24 18.588a1.529 1.529 0 0 1-1.895-.72l-3.45-4.771-.5-.667-4.003 5.444a1.466 1.466 0 0 1-1.802.708l5.158-6.92-4.798-6.251a1.595 1.595 0 0 1 1.9.666l3.576 4.83 3.596-4.81a1.435 1.435 0 0 1 1.788-.668L21.708 7.9l-2.522 3.283a.666.666 0 0 0 0 .994l4.804 6.412zM.002 11.576l.42-2.075c1.154-4.103 5.858-5.81 9.094-3.27 1.895 1.489 2.368 3.597 2.275 5.973H1.116C.943 16.447 4.005 19.009 7.92 17.7a4.078 4.078 0 0 0 2.582-2.876c.207-.666.548-.78 1.174-.588a5.417 5.417 0 0 1-2.589 3.957 6.272 6.272 0 0 1-7.306-.933 6.575 6.575 0 0 1-1.64-3.858c0-.235-.08-.455-.134-.666A88.33 88.33 0 0 1 0 11.577zm1.127-.286h9.654c-.06-3.076-2.001-5.258-4.59-5.278-2.882-.04-4.944 2.094-5.071 5.264z" fill="#000"/>',
  'Express.js': '<path d="M4 12h16M8 8l8 8M8 16l8-8" stroke="#000" fill="none" stroke-width="2"/>',
  Laravel: '<path d="M23.642 5.43a.364.364 0 0 1 .014.1v5.149c0 .135-.073.26-.189.326l-4.323 2.49v4.934a.378.378 0 0 1-.188.326L9.93 23.949a.316.316 0 0 1-.066.027c-.008.002-.016.008-.024.01a.348.348 0 0 1-.192 0c-.011-.002-.02-.008-.03-.012-.02-.008-.042-.014-.062-.025L.533 18.755a.376.376 0 0 1-.189-.326V2.974c0-.033.005-.066.014-.098.003-.012.01-.02.014-.032a.369.369 0 0 1 .023-.058c.004-.013.015-.022.023-.033l.033-.045c.012-.01.025-.018.037-.027.014-.012.027-.024.041-.034H.53L5.043.05a.375.375 0 0 1 .375 0L9.93 2.647h.002c.015.01.027.021.04.033l.038.027c.013.014.02.03.033.045.008.011.02.021.025.033.01.02.017.038.024.058.003.011.01.021.013.032.01.031.014.064.014.098v9.652l3.76-2.164V5.527c0-.033.004-.066.013-.098.003-.01.01-.02.013-.032a.487.487 0 0 1 .024-.059c.007-.012.018-.02.025-.033.012-.015.021-.03.033-.043.012-.012.025-.02.037-.028.014-.01.026-.023.041-.032h.001l4.513-2.598a.375.375 0 0 1 .375 0l4.513 2.598c.016.01.027.021.042.031.012.01.025.018.036.028.013.014.022.03.034.044.008.012.019.021.024.033.011.02.018.04.024.06.006.01.012.021.015.032zm-.74 5.032V6.179l-1.578.908-2.182 1.256v4.283zm-4.51 7.75v-4.287l-2.147 1.225-6.126 3.498v4.325zM1.093 3.624v14.588l8.273 4.761v-4.325l-4.322-2.445-.002-.003H5.04c-.014-.01-.025-.021-.04-.031-.011-.01-.024-.018-.035-.027l-.001-.002c-.013-.012-.021-.025-.031-.039-.01-.012-.021-.023-.028-.037h-.002c-.008-.014-.013-.031-.02-.047-.006-.016-.014-.027-.018-.043a.49.49 0 0 1-.008-.057c-.002-.014-.006-.027-.006-.041V5.789l-2.18-1.257zM5.23.81L1.47 2.974l3.76 2.164 3.758-2.164zm1.956 13.505l2.182-1.256V3.624l-1.58.91-2.18 1.255v9.435zm11.581-10.95l-3.76 2.163 3.76 2.163 3.759-2.164zm-.376 4.978L16.21 7.087 14.63 6.18v4.283l2.182 1.256 1.58.908zm-8.65 9.654l5.514-3.148 2.756-1.572-3.757-2.163-4.323 2.489-3.941 2.27z" fill="#FF2D20"/>',
  Spring: '<circle cx="12" cy="12" r="10" fill="#6db33f"/>',
  'Spring Boot': '<circle cx="12" cy="12" r="9" fill="#6db33f"/><path d="M16 8c-1-1-2.5-1.5-4-1.5S9 7 8 8c-1.5 1.5-1.5 4 0 5.5l4 4 4-4c1.5-1.5 1.5-4 0-5.5z" fill="#fff"/>',
  'ASP.NET': '<rect x="4" y="4" width="16" height="16" rx="2" fill="#512bd4"/>',
  Rails: '<path d="M12 4l7 5v7l-7 5-7-5V9l7-5z" fill="#cc0000"/><path d="M12 8v8M8 12h8" stroke="#fff" stroke-width="1.5"/>',
  Nest: '<path d="M12 2l10 6v8l-10 6-10-6V8z" fill="#e0234e"/>',
  'Nest.js': '<path d="M12 2l10 6v8l-10 6-10-6V8z" fill="#e0234e"/>',
  Gatsby: '<path d="M12 2l8.66 15H3.34L12 2z" fill="#663399"/><circle cx="12" cy="12" r="5" fill="#fff"/>',
  Astro: '<path d="M12 3l2.5 7.5L22 12l-7.5 1.5L12 21l-2.5-7.5L2 12l7.5-1.5L12 3z" fill="#ff5d01"/><circle cx="12" cy="12" r="3" fill="#fff"/>',
  Remix: '<rect x="5" y="5" width="14" height="14" rx="2" fill="#000"/><path d="M12 8v8M8 12h8" stroke="#fff" stroke-width="2"/>',
  SolidJS: '<path d="M12 3l8 5v8l-8 5-8-5V8l8-5z" fill="#2c4f7c"/><path d="M12 7l5 3v5l-5 3-5-3v-5l5-3z" fill="#446b9e"/>',
  Qwik: '<circle cx="12" cy="12" r="9" fill="#ac7ef4"/><path d="M12 6l4 6-4 6-4-6 4-6z" fill="#fff"/>',
  Tauri: '<circle cx="12" cy="12" r="9" fill="#ffc131"/><path d="M12 6c-3.3 0-6 2.7-6 6s2.7 6 6 6 6-2.7 6-6-2.7-6-6-6zm0 10c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z" fill="#24c8db"/>',
  Electron: '<circle cx="12" cy="12" r="9" fill="#47848f"/><ellipse cx="12" cy="12" rx="8" ry="3" stroke="#9feaf9" stroke-width="1" fill="none"/><ellipse cx="12" cy="12" rx="8" ry="3" stroke="#9feaf9" stroke-width="1" fill="none" transform="rotate(60 12 12)"/><ellipse cx="12" cy="12" rx="8" ry="3" stroke="#9feaf9" stroke-width="1" fill="none" transform="rotate(120 12 12)"/><circle cx="12" cy="12" r="2" fill="#9feaf9"/>',
  FastAPI: '<circle cx="12" cy="12" r="9" fill="#009688"/><path d="M12 6v12M6 12h12M9 9l6 6M15 9l-6 6" stroke="#fff" stroke-width="1.5"/>',
  Tailwind: '<path d="M12.001 4.8c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-1.8.913.228 1.565.89 2.288 1.624C13.666 10.618 15.027 12 18.001 12c3.2 0 5.2-1.6 6-4.8-1.2 1.6-2.6 2.2-4.2 1.8-.913-.228-1.565-.89-2.288-1.624C16.337 6.182 14.976 4.8 12.001 4.8zm-6 7.2c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-1.8.913.228 1.565.89 2.288 1.624 1.177 1.194 2.538 2.576 5.512 2.576 3.2 0 5.2-1.6 6-4.8-1.2 1.6-2.6 2.2-4.2 1.8-.913-.228-1.565-.89-2.288-1.624C10.337 13.382 8.976 12 6.001 12z" fill="#06B6D4"/>',
  'Tailwind CSS': '<path d="M12 6c-2 0-3.3.5-4 1.5.8-1 1.7-1.4 2.5-1.4 1.2 0 1.5.6 2.5 1.4 1.5 1.2 3.2 2.5 6 2.5-2 0-3.3.5-4 1.5.8-1 1.7-1.4 2.5-1.4 1.2 0 1.5.6 2.5 1.4 1.5 1.2 3.2 2.5 6 2.5" stroke="#06B6D4" fill="none" stroke-width="1.5"/>',
  Bootstrap: '<path d="M6.564 15.509c.066.073.135.147.203.22.899.972 2.14 1.472 3.685 1.472 1.563 0 2.834-.495 3.787-1.467.914-.936 1.388-2.165 1.388-3.594 0-1.43-.474-2.66-1.388-3.595-.953-.973-2.224-1.468-3.787-1.468-1.545 0-2.786.5-3.685 1.472-.068.073-.137.147-.203.22V4.486H1.292v15.028h5.272V15.51zM10.496 9.09c.723 0 1.307.268 1.73.788.42.517.635 1.188.635 1.991 0 .803-.215 1.474-.634 1.99-.424.52-1.008.788-1.731.788s-1.307-.268-1.73-.788c-.42-.516-.635-1.187-.635-1.99 0-.803.215-1.474.634-1.99.424-.521 1.008-.789 1.731-.789zm12.212 5.867c-.068-.073-.137-.147-.203-.22-.899-.972-2.14-1.472-3.685-1.472-1.563 0-2.834.495-3.787 1.467-.914.936-1.388 2.165-1.388 3.594s.474 2.66 1.388 3.595c.953.973 2.224 1.468 3.787 1.468 1.545 0 2.786-.5 3.685-1.472.068-.073.137-.147.203-.22v3.72h5.272V4.485h-5.272v10.472zm-3.888-1.012c.723 0 1.307.268 1.73.788.42.517.635 1.188.635 1.991 0 .803-.215 1.474-.634 1.99-.424.52-1.008.788-1.731.788s-1.307-.268-1.73-.788c-.42-.516-.635-1.187-.635-1.99 0-.803.215-1.474.634-1.99.424-.521 1.008-.789 1.731-.789z" fill="#7952B3"/>',
  jQuery: '<path d="M3 16c0 2.5 2 4.5 4.5 4.5S12 18.5 12 16v-6c0-2.5-2-4.5-4.5-4.5S3 7.5 3 10v6zm9-6c0 2.5 2 4.5 4.5 4.5S21 12.5 21 10V4c0-2.5-2-4.5-4.5-4.5S12 1.5 12 4v6z" fill="#0769AD"/>',
  Vite: '<path fill="#646CFF" d="m8.286 10.578.512-8.657a.306.306 0 0 1 .247-.282L17.377.006a.306.306 0 0 1 .353.385l-1.558 5.403a.306.306 0 0 0 .352.385l2.388-.46a.306.306 0 0 1 .332.438l-6.79 13.55-.123.19a.294.294 0 0 1-.252.14c-.177 0-.35-.152-.305-.369l1.095-5.301a.306.306 0 0 0-.388-.355l-1.433.435a.306.306 0 0 1-.389-.354l.69-3.375a.306.306 0 0 0-.37-.36l-2.32.536a.306.306 0 0 1-.374-.316z"/><path fill="url(#a)" d="m8.286 10.578.512-8.657a.306.306 0 0 1 .247-.282L17.377.006a.306.306 0 0 1 .353.385l-1.558 5.403a.306.306 0 0 0 .352.385l2.388-.46a.306.306 0 0 1 .332.438l-6.79 13.55-.123.19a.294.294 0 0 1-.252.14c-.177 0-.35-.152-.305-.369l1.095-5.301a.306.306 0 0 0-.388-.355l-1.433.435a.306.306 0 0 1-.389-.354l.69-3.375a.306.306 0 0 0-.37-.36l-2.32.536a.306.306 0 0 1-.374-.316z"/><path fill="url(#b)" d="M11.042 23.988a.306.306 0 0 1-.252-.14l-.123-.19L.858 7.46a.306.306 0 0 1 .332-.438l2.388.46a.306.306 0 0 0 .352-.384L2.372.695a.306.306 0 0 1 .353-.385l8.332 1.633a.306.306 0 0 1 .247.282l.512 8.657a.306.306 0 0 1-.374.316l-2.32-.536a.306.306 0 0 0-.37.36l.69 3.375a.306.306 0 0 1-.389.354l-1.433-.435a.306.306 0 0 0-.388.355l1.095 5.301c.045.217-.128.369-.305.369z"/><defs><linearGradient id="a" x1="6.001" x2="235.988" y1="26.238" y2="21.534" gradientUnits="userSpaceOnUse"><stop stop-color="#41D1FF"/><stop offset="1" stop-color="#BD34FE"/></linearGradient><linearGradient id="b" x1="194.651" x2="236.076" y1="8.818" y2="292.989" gradientUnits="userSpaceOnUse"><stop stop-color="#FFEA83"/><stop offset=".083" stop-color="#FFDD35"/><stop offset="1" stop-color="#FFA800"/></linearGradient></defs>',
  Webpack: '<path d="M12 3l8 5v8l-8 5-8-5V8l8-5z" fill="#8DD6F9"/><path d="M12 6v12M6 9l6 3M18 9l-6 3" stroke="#1C78C0" stroke-width="1.5"/>',
  Bun: '<path d="M113.744 41.999a18.558 18.558 0 0 0-.8-.772c-.272-.246-.528-.524-.8-.771s-.528-.525-.8-.771c-.272-.247-.528-.525-.8-.772s-.528-.524-.8-.771-.528-.525-.8-.772-.528-.524-.8-.771c7.936 7.52 12.483 17.752 12.656 28.481 0 25.565-26.912 46.363-60 46.363-18.528 0-35.104-6.526-46.128-16.756l.8.772.8.771.8.772.8.771.8.772.8.771.8.771c11.008 10.662 27.952 17.527 46.928 17.527 33.088 0 60-20.797 60-46.285 0-10.893-4.864-21.215-13.456-29.33z"></path><path fill="#fbf0df" d="M116.8 65.08c0 23.467-25.072 42.49-56 42.49s-56-19.023-56-42.49c0-14.55 9.6-27.401 24.352-35.023C43.904 22.435 53.088 14.628 60.8 14.628S75.104 21 92.448 30.058C107.2 37.677 116.8 50.53 116.8 65.08Z"></path><path fill="#f6dece" d="M116.8 65.08a32.314 32.314 0 0 0-1.28-8.918c-4.368 51.377-69.36 53.846-94.912 38.48 11.486 8.584 25.66 13.144 40.192 12.928 30.88 0 56-19.054 56-42.49z"></path><path fill="#fffefc" d="M39.248 27.234c7.152-4.135 16.656-11.896 26-11.911a15.372 15.372 0 0 0-4.448-.695c-3.872 0-8 1.93-13.2 4.83-1.808 1.018-3.68 2.144-5.664 3.317-3.728 2.222-8 4.736-12.8 7.251C13.904 37.972 4.8 51.071 4.8 65.08v1.836c9.696-33.033 27.312-35.547 34.448-39.682z"></path><path fill="#ccbea7" d="M56.192 18.532A24.553 24.553 0 0 1 53.867 29.1a25.407 25.407 0 0 1-6.683 8.671c-.448.386-.096 1.127.48.91 5.392-2.02 12.672-8.068 9.6-20.272-.128-.695-1.072-.51-1.072.123zm3.632 0a24.474 24.474 0 0 1 3.646 10.12c.445 3.587.08 7.224-1.07 10.662-.192.54.496 1.003.88.556 3.504-4.32 6.56-12.899-2.592-22.156-.464-.4-1.184.216-.864.756zm4.416-.262a25.702 25.702 0 0 1 7.521 7.925A24.71 24.71 0 0 1 75.2 36.414c-.016.13.02.26.101.365a.543.543 0 0 0 .718.117.509.509 0 0 0 .221-.313c1.472-5.384.64-14.564-11.472-19.332-.64-.246-1.056.587-.528.957zM34.704 34.315a27.418 27.418 0 0 0 9.91-5.222 26.262 26.262 0 0 0 6.842-8.663c.288-.556 1.2-.34 1.056.277-2.768 12.343-12.032 14.92-17.792 14.58-.608.016-.592-.802-.016-.972z"></path><path d="M60.8 111.443c-33.088 0-60-20.798-60-46.363 0-15.429 9.888-29.823 26.448-38.448 4.8-2.469 8.912-4.953 12.576-7.128 2.016-1.203 3.92-2.33 5.76-3.379C51.2 12.916 56 10.771 60.8 10.771c4.8 0 8.992 1.852 14.24 4.845 1.6.88 3.2 1.836 4.912 2.885 3.984 2.376 8.48 5.06 14.4 8.131 16.56 8.625 26.448 23.004 26.448 38.448 0 25.565-26.912 46.363-60 46.363zm0-96.814c-3.872 0-8 1.928-13.2 4.829-1.808 1.018-3.68 2.144-5.664 3.317-3.728 2.222-8 4.736-12.8 7.251C13.904 37.972 4.8 51.071 4.8 65.08c0 23.436 25.12 42.506 56 42.506s56-19.07 56-42.506c0-14.01-9.104-27.108-24.352-35.023-6.048-3.086-10.768-5.986-14.592-8.27-1.744-1.033-3.344-1.99-4.8-2.838-4.848-2.778-8.384-4.32-12.256-4.32z"></path><path fill="#b71422" d="M72.08 76.343c-.719 2.839-2.355 5.383-4.672 7.267a11.07 11.07 0 0 1-6.4 2.9 11.13 11.13 0 0 1-6.608-2.9c-2.293-1.892-3.906-4.436-4.608-7.267a1.073 1.073 0 0 1 .05-.5 1.11 1.11 0 0 1 .272-.428 1.19 1.19 0 0 1 .958-.322h19.744a1.185 1.185 0 0 1 .947.33 1.073 1.073 0 0 1 .317.92z"></path><path fill="#ff6164" d="M54.4 83.733a11.24 11.24 0 0 0 6.592 2.932 11.239 11.239 0 0 0 6.576-2.932 16.652 16.652 0 0 0 1.6-1.65 10.904 10.904 0 0 0-3.538-2.564 11.26 11.26 0 0 0-4.302-1 10.121 10.121 0 0 0-4.549 1.192 9.71 9.71 0 0 0-3.451 3.097c.368.323.688.632 1.072.925z"></path><path d="M54.656 82.514a8.518 8.518 0 0 1 2.97-2.347 8.836 8.836 0 0 1 3.734-.862 9.78 9.78 0 0 1 6.4 2.608c.368-.386.72-.787 1.056-1.188-2.035-1.87-4.726-2.933-7.536-2.978a10.487 10.487 0 0 0-4.335.975 10.125 10.125 0 0 0-3.489 2.666c.378.396.779.772 1.2 1.126z"></path><path d="M60.944 87.436a12.078 12.078 0 0 1-7.12-3.086c-2.477-2.02-4.22-4.75-4.976-7.791-.054-.27-.045-.55.027-.817a1.83 1.83 0 0 1 .389-.726 2.25 2.25 0 0 1 .81-.595 2.32 2.32 0 0 1 .998-.192h19.744c.343-.007.683.06.996.196a2.3 2.3 0 0 1 .812.591c.182.212.313.46.382.728.07.267.076.545.018.815-.756 3.042-2.5 5.771-4.976 7.791a12.078 12.078 0 0 1-7.104 3.086zm-9.872-11.417c-.256 0-.32.108-.336.139.676 2.638 2.206 4.999 4.368 6.742a10.122 10.122 0 0 0 5.84 2.7 10.207 10.207 0 0 0 5.84-2.67c2.155-1.745 3.679-4.106 4.352-6.741a.333.333 0 0 0-.14-.113.348.348 0 0 0-.18-.026z"></path><path fill="#febbd0" d="M85.152 77.3c5.17 0 9.36-2.377 9.36-5.308s-4.19-5.307-9.36-5.307c-5.17 0-9.36 2.376-9.36 5.307 0 2.931 4.19 5.307 9.36 5.307zm-48.432 0c5.17 0 9.36-2.377 9.36-5.308s-4.19-5.307-9.36-5.307c-5.17 0-9.36 2.376-9.36 5.307 0 2.931 4.19 5.307 9.36 5.307z"></path><path d="M41.12 69.863a9.052 9.052 0 0 0 4.902-1.425 8.578 8.578 0 0 0 3.254-3.812 8.22 8.22 0 0 0 .508-4.913 8.41 8.41 0 0 0-2.408-4.357 8.92 8.92 0 0 0-4.514-2.33 9.12 9.12 0 0 0-5.096.48 8.755 8.755 0 0 0-3.96 3.131 8.287 8.287 0 0 0-1.486 4.725c0 2.252.927 4.412 2.577 6.005 1.65 1.594 3.888 2.492 6.223 2.496zm39.632 0a9.054 9.054 0 0 0 4.915-1.403 8.582 8.582 0 0 0 3.275-3.802 8.22 8.22 0 0 0 .528-4.917 8.408 8.408 0 0 0-2.398-4.368 8.92 8.92 0 0 0-4.512-2.344 9.12 9.12 0 0 0-5.103.473 8.756 8.756 0 0 0-3.967 3.13 8.287 8.287 0 0 0-1.49 4.73c-.004 2.245.914 4.4 2.555 5.994 1.64 1.593 3.869 2.495 6.197 2.507z"></path><path fill="#fff" d="M38.4 61.902a3.4 3.4 0 0 0 1.844-.531c.547-.35.974-.847 1.227-1.43a3.088 3.088 0 0 0 .195-1.847 3.16 3.16 0 0 0-.902-1.639 3.351 3.351 0 0 0-1.696-.878 3.426 3.426 0 0 0-1.916.179 3.29 3.29 0 0 0-1.489 1.176 3.113 3.113 0 0 0-.559 1.776c0 .844.347 1.654.964 2.253a3.374 3.374 0 0 0 2.332.94zm39.632 0a3.4 3.4 0 0 0 1.844-.531c.547-.35.974-.847 1.227-1.43a3.088 3.088 0 0 0 .195-1.847 3.16 3.16 0 0 0-.902-1.639 3.351 3.351 0 0 0-1.696-.878 3.426 3.426 0 0 0-1.916.179 3.29 3.29 0 0 0-1.489 1.176 3.113 3.113 0 0 0-.559 1.776c0 .84.342 1.644.953 2.242.61.598 1.44.94 2.311.952z"></path>',
};

const osIcons: Record<string, string> = {
  Linux: '<path d="M12 2c-1.5 0-2.8 1.2-3.2 2.8-.3 1.2-.8 2-1.8 3.2-1 1.2-2 2.5-2.5 4-.2.8-.3 1.5-.1 2 .5 1.2 1.8 1.3 2.8 1.1 1.7-.4 2.8-2 3-2.3.6-1 .8-1.3 1.4-2.1.6-.8 1.5-1.1 2.1-1.1s1.5.3 2.1 1.1c.6.8.8 1.2 1.4 2.1.2.2 1.2 1.9 3 2.3 1 .2 2.2.1 2.8-1.1.2-.5.1-1.2-.1-2-.5-1.5-1.5-2.8-2.5-4-1-1.1-1.5-1.9-1.8-3.2C14.8 3.2 13.5 2 12 2zm0 3c.3 0 .5.2.5.5s-.2.5-.5.5-.5-.2-.5-.5.2-.5.5-.5zm-4.3 5.5c.2 0 .3.1.3.3s-.1.3-.3.3-.3-.1-.3-.3.1-.3.3-.3zm8.6 0c.2 0 .3.1.3.3s-.1.3-.3.3-.3-.1-.3-.3.1-.3.3-.3zM12 14c-1.2 0-2.2.5-3 1.2-.4.4-.8.8-1 1.3-.2.5-.3 1-.2 1.5.2 1 1 1.8 2 2 .8.2 1.5 0 2.2-.5.7.5 1.4.7 2.2.5 1-.2 1.8-1 2-2 .1-.5 0-1-.2-1.5-.2-.5-.6-.9-1-1.3-.8-.7-1.8-1.2-3-1.2z" fill="#FCC624"/>',
  Ubuntu: '<circle cx="12" cy="12" r="10" fill="none" stroke="#E95420" stroke-width="1.5"/><circle cx="12" cy="5" r="2.2" fill="#E95420"/><circle cx="18.5" cy="15.5" r="2.2" fill="#E95420"/><circle cx="5.5" cy="15.5" r="2.2" fill="#E95420"/><path d="M12 7v5m4.3 1.5l-4.3-2.5m-4.3 2.5l4.3-2.5" stroke="#E95420" stroke-width="1.5" fill="none"/>',
  Debian: '<path d="M14.5 5.8c-.4 0-.7.1-1 .2l.1-.4c.3-.1.6-.1.9-.1v.3zm-.9.7c-.5.3-1 .7-1.3 1.2-.2.3-.4.6-.6.9l.6-.3c.2-.3.4-.6.7-.9.4-.4.8-.7 1.2-1l-.6.1zm-2.1 2.4c-.2.5-.3 1-.3 1.5 0 .2 0 .4.1.6l.5-.1c0-.2 0-.4 0-.6 0-.5.1-1 .3-1.4l-.6-.1zm-.2 2.6c0 .5.1 1 .3 1.5.1.2.2.5.4.7l.4-.3c-.2-.2-.3-.5-.4-.7-.2-.5-.3-1-.3-1.5l-.5.2zm.8 2.5c.3.5.7.9 1.2 1.3.2.2.5.4.8.5l.2-.4c-.3-.2-.5-.4-.8-.6-.4-.4-.8-.9-1.2-1.4l-.3.6zm2.2 2.1c.5.2 1 .3 1.5.3.2 0 .4 0 .6-.1l-.1-.5c-.2 0-.4 0-.6 0-.5 0-1-.1-1.4-.3l-.1.6zm2.6-.2c.5 0 1-.1 1.5-.3.2-.1.5-.2.7-.4l-.3-.4c-.2.2-.5.3-.7.4-.5.2-1 .3-1.5.3l.2.5zm2.5-.8c.5-.3.9-.7 1.3-1.2.2-.2.4-.5.5-.8l-.4-.2c-.2.3-.4.5-.6.8-.4.4-.9.8-1.4 1.2l.3.3zm2.1-2.2c.2-.5.3-1 .3-1.5 0-.2 0-.4-.1-.6l-.5.1c0 .2 0 .4 0 .6 0 .5-.1 1-.3 1.5l.6.1zm.2-2.6c0-.5-.1-1-.3-1.5-.1-.2-.2-.5-.4-.7l-.4.3c.2.2.3.5.4.7.2.5.3 1 .3 1.5l.5-.2zm-.8-2.5c-.3-.5-.7-.9-1.2-1.3-.2-.2-.5-.4-.8-.5l-.2.4c.3.2.5.4.8.6.4.4.8.9 1.2 1.4l.3-.6zm-2.2-2.1c-.5-.2-1-.3-1.5-.3-.2 0-.4 0-.6.1l.1.5c.2 0 .4 0 .6 0 .5 0 1 .1 1.4.3l.1-.6z" fill="#D70A53"/>',
  Fedora: '<path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm3.5 14h-2.8v-2.5h-2.4V16H7.5v-2.5c0-2.2 1.8-4 4-4h1.2V7h2.8v2.5h-2.8v2.5h2.8V16z" fill="#3C6EB4"/>',
  CentOS: '<path d="M12 2L2 12l10 10 10-10L12 2zm0 2.8L19.2 12 12 19.2 4.8 12 12 4.8z" fill="#932279"/><path d="M12 8l-2.5 4h5L12 8zm-4 6l2.5-2.5V16H8zm8 0h-2.5v-4.5L16 14z" fill="#932279"/>',
  'Arch Linux': '<path d="M12 3.5c-.4.7-.9 1.5-1.4 2.3-.4.7-.9 1.4-1.4 2.2l-.2.3c-.2.3-.3.5-.5.8-1 1.5-2 3.1-3.2 4.9-.6.9-1.2 1.8-1.9 2.8.7-.2 1.4-.4 2-.7.9-.3 1.8-.7 2.6-1 .8-.4 1.6-.7 2.4-1.1.8-.4 1.5-.7 2.2-1.1.7.4 1.4.7 2.2 1.1.8.4 1.6.7 2.4 1.1.8.3 1.7.7 2.6 1 .6.3 1.3.5 2 .7-.6-.9-1.2-1.8-1.9-2.8-1.2-1.8-2.2-3.4-3.2-4.9-.2-.3-.3-.5-.5-.8l-.2-.3c-.5-.8-1-1.5-1.4-2.2-.5-.8-1-1.6-1.4-2.3z" fill="#1793D1"/>',
  Manjaro: '<path d="M4 4v16h5V9h6v11h5V4z" fill="#35BF5C"/>',
  openSUSE: '<circle cx="12" cy="12" r="5" fill="none" stroke="#73BA25" stroke-width="2"/><circle cx="6" cy="12" r="3" fill="#73BA25"/><circle cx="18" cy="12" r="3" fill="#73BA25"/>',
  'Red Hat': '<path d="M18.5 11.5c0-.8-2-1.5-4-1.5s-4 .7-4 1.5c0 .5.5 1 1.3 1.3-.3-.2-.5-.5-.5-.8 0-.6 1.3-1 3-1s3 .4 3 1c0 .3-.2.6-.5.8.8-.3 1.3-.8 1.3-1.3z" fill="#EE0000"/><path d="M16 7c.8 0 1.5-.7 1.5-1.5S16.8 4 16 4s-1.5.7-1.5 1.5S15.2 7 16 7zm-6 0c.8 0 1.5-.7 1.5-1.5S10.8 4 10 4 8.5 4.7 8.5 5.5 9.2 7 10 7z" fill="#EE0000"/><path d="M19 12c-.2.5-.7 1-1.5 1.3-1 .4-2.3.7-3.5.7s-2.5-.3-3.5-.7c-.8-.3-1.3-.8-1.5-1.3-.3.7-.5 1.5-.5 2.3 0 3.3 2.7 6 6 6s6-2.7 6-6c0-.8-.2-1.6-.5-2.3z" fill="#EE0000"/>',
  Windows: '<path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801" fill="#00A4EF"/>',
  'Windowns 8': '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M.011 16 0 6.248l12-1.63V16zM14 4.328 29.996 2v14H14zM30 18l-.004 14L14 29.75V18zM12 29.495.01 27.851.009 18H12z"/></svg>',
  'Windows 11': '<rect x="2" y="2" width="9" height="9" rx="1" fill="#0078D4"/><rect x="13" y="2" width="9" height="9" rx="1" fill="#0078D4"/><rect x="2" y="13" width="9" height="9" rx="1" fill="#0078D4"/><rect x="13" y="13" width="9" height="9" rx="1" fill="#0078D4"/>',
  'Windows Server': '<path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801" fill="#0078D4"/>',
  macOS: '<path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z" fill="#000"/>',
  Android: '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M28 12c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2s2-.9 2-2v-8c0-1.1-.9-2-2-2zM4 12c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2s2-.9 2-2v-8c0-1.1-.9-2-2-2zm3 11a3 3 0 0 0 3 3v4c0 1.1.9 2 2 2s2-.9 2-2v-4h4v4c0 1.1.9 2 2 2s2-.9 2-2v-4a3 3 0 0 0 3-3V12H7v11zM24.944 10a8.994 8.994 0 0 0-4.051-6.551l1.001-2.001a1 1 0 0 0-1.789-.895l-1.004 2.009-.261-.104C17.947 2.161 16.992 2 16 2s-1.947.161-2.84.458l-.261.104L11.895.553a1 1 0 0 0-1.789.895l1.001 2.001A8.996 8.996 0 0 0 7.056 10v1H25v-1h-.056zM13 8a1 1 0 0 1-.002-2h.005a1 1 0 0 1-.002 2zm6 0a1 1 0 0 1-.002-2h.005a1 1 0 0 1-.002 2z"/></svg>',
  iOS: '<path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z" fill="#000"/>',
  Alpine: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 120 125"><path fill-rule="evenodd" d="M61.113 4.886C55.82 17.788 52.629 26.23 46.738 38.749c3.613 3.805 8.047 8.242 15.246 13.25-7.742-3.168-13.02-6.347-16.969-9.648-7.539 15.644-19.351 37.933-43.324 80.77 18.844-10.817 33.45-17.485 47.059-20.032a33.989 33.989 0 0 1-.895-8.023l.024-.602c.296-12.004 6.578-21.238 14.015-20.61 7.438.626 13.223 10.872 12.922 22.876-.055 2.261-.312 4.433-.762 6.449 13.465 2.621 27.914 9.273 46.5 19.941-3.664-6.707-6.933-12.757-10.058-18.52-4.922-3.792-10.055-8.726-20.524-14.073 7.196 1.863 12.348 4.007 16.364 6.406C74.578 38.12 72.004 30.308 61.113 4.886Zm0 0"/></svg>',
  'Kali Linux': '<path d="M12 2c-3.9 0-7 3.1-7 7 0 1.3.3 2.5 1 3.6L12 22l5-9.4c.7-1.1 1-2.3 1-3.6 0-3.9-3.1-7-7-7zm0 4c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3z" fill="#367BF0"/>',
};

const customIcons: Record<string, string> = {
  star: '<path d="M12 2l3 9h9l-7 5 3 9-8-6-8 6 3-9-7-5h9z" fill="currentColor"/>',
  heart: '<path d="M12 21l-1.5-1.4C5.4 15.4 2 12.3 2 8.5 2 5.4 4.4 3 7.5 3c1.7 0 3.4.8 4.5 2.1C13.1 3.8 14.8 3 16.5 3 19.6 3 22 5.4 22 8.5c0 3.8-3.4 6.9-8.5 11.1L12 21z" fill="currentColor"/>',
  fire: '<path d="M12 2c1 3-1 5-1 7 0 2.2 1.8 4 4 4 1 0 2-.4 2.6-1.1.1.4.1.7.1 1.1 0 3.3-2.7 6-6 6s-6-2.7-6-6c0-4 3-7 5-9.5.5 1 1 2.5 1 3.5 0-1.5 1-3.5 1-5z" fill="currentColor"/>',
  trophy: '<path d="M7 4h10v2c0 2.2-1.8 4-4 4h-2c-2.2 0-4-1.8-4-4V4z M5 4h2M17 4h2M12 10v4M9 14h6v2c0 1.1-.9 2-2 2h-2c-1.1 0-2-.9-2-2v-2z M8 18h8v2H8z" stroke="currentColor" fill="none" stroke-width="1.5" stroke-linecap="round"/>',
  rocket: '<path d="M12 2l8 8c-2 4-4 6-8 8-4-2-6-4-8-8l8-8z M12 14c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z M6 18c0 2 1 4 6 4s6-2 6-4" stroke="currentColor" fill="none" stroke-width="1.5" stroke-linecap="round"/>',
  code: '<path d="M8 6l-6 6 6 6M16 6l6 6-6 6M14 2l-4 20" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round"/>',
  download: '<path d="M12 2v14M5 12l7 7 7-7M4 20h16" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round"/>',
  check: '<path d="M4 12l6 6L20 6" stroke="currentColor" fill="none" stroke-width="3" stroke-linecap="round"/>',
  users: '<circle cx="9" cy="8" r="4" fill="currentColor"/><circle cx="17" cy="8" r="3" fill="currentColor"/><path d="M3 20c0-3 3-5 6-5s6 2 6 5M15 20c0-2 2-4 4-4s4 2 4 4" stroke="currentColor" fill="none" stroke-width="1.5"/>',
  eye: '<circle cx="12" cy="12" r="3" fill="currentColor"/><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" stroke="currentColor" fill="none" stroke-width="1.5"/>',
};
const socialIcons: Record<string, string> = {
  github: '<path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z" fill="currentColor"/>',
  twitter: '<path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z" fill="currentColor"/>',
  youtube: '<path d="M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78 0 003.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z" fill="currentColor"/><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02" fill="#fff"/>',
  discord: '<path d="M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 00-5.487 0 12.64 12.64 0 00-.617-1.25.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.07.07 0 00-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 00-.031-.03z" fill="currentColor"/>',
  linkedin: '<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" fill="currentColor"/>',
  instagram: '<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z" fill="currentColor"/>',
  facebook: '<path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" fill="currentColor"/>',
  reddit: '<path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z" fill="currentColor"/>',
  telegram: '<path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z" fill="currentColor"/>',
  tiktok: '<path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z" fill="currentColor"/>',
  twitch: '<path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z" fill="currentColor"/>',
  wikipedia: '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M30.212 7.3a.47.47 0 0 1-.094.281c-.063.081-.131.125-.212.125-.625.063-1.137.263-1.531.6-.4.338-.806.994-1.225 1.95L20.7 24.8c-.044.137-.163.2-.356.2a.41.41 0 0 1-.356-.2l-3.619-7.563-4.162 7.563c-.088.137-.2.2-.356.2-.188 0-.306-.069-.369-.2L5.151 10.263c-.394-.9-.813-1.531-1.25-1.887s-1.05-.581-1.831-.662c-.069 0-.131-.037-.188-.106a.343.343 0 0 1-.087-.244c0-.237.069-.356.2-.356.562 0 1.156.025 1.775.075.575.05 1.112.075 1.619.075.513 0 1.125-.025 1.825-.075.731-.05 1.381-.075 1.95-.075.137 0 .2.119.2.356s-.044.35-.125.35c-.563.044-1.012.188-1.338.431s-.487.563-.487.963c0 .2.069.456.2.756l5.231 11.825 2.975-5.613-2.769-5.806c-.5-1.037-.906-1.706-1.225-2.006s-.806-.481-1.456-.55c-.063 0-.113-.037-.169-.106s-.081-.15-.081-.244c0-.237.056-.356.175-.356.563 0 1.081.025 1.556.075.456.05.938.075 1.456.075.506 0 1.037-.025 1.606-.075.581-.05 1.156-.075 1.719-.075.137 0 .2.119.2.356s-.038.35-.125.35c-1.131.075-1.694.4-1.694.963 0 .25.131.644.394 1.175l1.831 3.719 1.825-3.4c.25-.481.381-.887.381-1.213 0-.775-.563-1.188-1.694-1.237-.1 0-.15-.119-.15-.35 0-.088.025-.162.075-.237s.1-.112.15-.112c.406 0 .9.025 1.494.075.563.05 1.031.075 1.394.075.262 0 .644-.025 1.15-.063a19.14 19.14 0 0 1 1.606-.088c.1 0 .15.1.15.3 0 .269-.094.406-.275.406-.656.069-1.188.25-1.587.544s-.9.963-1.5 2.013l-2.444 4.475 3.288 6.7 4.856-11.294c.169-.412.25-.794.25-1.137 0-.825-.563-1.263-1.694-1.319-.1 0-.15-.119-.15-.35 0-.237.075-.356.225-.356.413 0 .9.025 1.469.075.525.05.962.075 1.313.075.375 0 .8-.025 1.288-.075.506-.05.962-.075 1.369-.075.125 0 .188.1.188.3z"/></svg>',
  spotify: '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M16 0C7.2 0 0 7.2 0 16s7.2 16 16 16 16-7.2 16-16S24.881 0 16 0zm7.363 23.119c-.319.481-.881.637-1.363.319-3.762-2.319-8.481-2.8-14.081-1.519-.563.163-1.037-.238-1.2-.719-.162-.563.237-1.038.719-1.2 6.081-1.363 11.363-.8 15.519 1.762.563.238.644.875.406 1.356zm1.918-4.4c-.4.563-1.119.8-1.681.4-4.319-2.637-10.881-3.438-15.919-1.837-.638.163-1.362-.163-1.519-.8-.162-.637.162-1.363.8-1.519 5.838-1.762 13.037-.881 18 2.163.475.238.719 1.038.319 1.594zm.157-4.481c-5.119-3.037-13.681-3.363-18.563-1.838-.8.238-1.6-.238-1.838-.963-.237-.8.237-1.6.963-1.838 5.681-1.681 15.038-1.363 20.962 2.162.719.4.962 1.363.563 2.081-.406.556-1.363.794-2.087.394z"/></svg>',
  paypal: '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M29.063 9.644c-1.494 6.631-6.106 10.131-13.375 10.131h-2.419L11.588 30.45H9.563l-.106.688a.748.748 0 0 0 .738.863h5.175c.613 0 1.131-.444 1.231-1.05l.05-.262.975-6.181.063-.337a1.244 1.244 0 0 1 1.231-1.05h.769c5.012 0 8.938-2.038 10.088-7.925.431-2.238.269-4.137-.712-5.55z"/><path d="M25.969 2.413C24.488.725 21.806 0 18.382 0H8.438c-.7 0-1.3.506-1.406 1.2L2.888 27.462a.855.855 0 0 0 .844.988h6.144l1.544-9.781-.05.306c.106-.694.7-1.2 1.4-1.2h2.919c5.731 0 10.219-2.325 11.531-9.063.038-.2.075-.394.1-.581.387-2.487 0-4.188-1.35-5.719z"/></svg>',
  whatsapp: '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M27.281 4.65C24.287 1.65 20.306 0 16.062 0 7.324 0 .212 7.112.212 15.856c0 2.794.731 5.525 2.119 7.925L.081 32l8.406-2.206a15.858 15.858 0 0 0 7.575 1.931h.006c8.738 0 15.856-7.113 15.856-15.856 0-4.238-1.65-8.219-4.644-11.219zm-11.212 24.4a13.17 13.17 0 0 1-6.713-1.837l-.481-.288-4.987 1.306 1.331-4.863-.313-.5a13.086 13.086 0 0 1-2.019-7.012c0-7.269 5.912-13.181 13.188-13.181 3.519 0 6.831 1.375 9.319 3.862a13.108 13.108 0 0 1 3.856 9.325c-.006 7.275-5.919 13.188-13.181 13.188zm7.225-9.875c-.394-.2-2.344-1.156-2.706-1.288s-.625-.2-.894.2c-.262.394-1.025 1.288-1.256 1.556-.231.262-.462.3-.856.1s-1.675-.619-3.188-1.969c-1.175-1.05-1.975-2.35-2.206-2.744s-.025-.613.175-.806c.181-.175.394-.463.594-.694s.262-.394.394-.662c.131-.262.069-.494-.031-.694s-.894-2.15-1.219-2.944c-.319-.775-.65-.669-.894-.681-.231-.012-.494-.012-.756-.012s-.694.1-1.056.494c-.363.394-1.387 1.356-1.387 3.306s1.419 3.831 1.619 4.1c.2.262 2.794 4.269 6.769 5.981.944.406 1.681.65 2.256.837.95.3 1.813.256 2.494.156.762-.113 2.344-.956 2.675-1.881s.331-1.719.231-1.881c-.094-.175-.356-.275-.756-.475z"/></svg>',
  steam: '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M22 9a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm7.95-4.95A7 7 0 0 0 18.071 8l-6.397 9.695a6.3 6.3 0 0 0-2.499.657l-4.934-3.857a2.625 2.625 0 1 0-3.233 4.136l4.873 3.809a6.313 6.313 0 1 0 12.335.457l7.783-6.968a6.999 6.999 0 0 0 3.95-11.878zM12 28.209A4.208 4.208 0 0 1 7.791 24l.002-.066 2.091 1.634c.48.375 1.049.557 1.615.557a2.625 2.625 0 0 0 1.619-4.694l-1.984-1.551a4.208 4.208 0 1 1 .868 8.328zM25 14a5 5 0 1 1 .001-10.001A5 5 0 0 1 25 14z"/></svg>',
};
// Utility functions
function getTextEffects(effect: string, color: string): string {
  const effects: Record<string, string> = {
    shadow: `text-shadow: 2px 2px 4px rgba(0,0,0,0.3);`,
    glow: `filter: drop-shadow(0 0 8px ${color});`,
    fade: `opacity: 0; animation: fadeIn 1s ease-in forwards;`,
    slide: `transform: translateX(-20px); opacity: 0; animation: slideIn 0.8s ease-out forwards;`
  };
  return effects[effect as keyof typeof effects] || '';
}
function parseColor(color: string | undefined, defaultColor: string): string {
  if (!color) return defaultColor;
  
  if (color.includes(',')) {
    const match = color.match(/(\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
      return `rgb(${match[1]}, ${match[2]}, ${match[3]})`;
    }
  }
  
  if (color.startsWith('#') || /^[0-9A-Fa-f]{6}$/.test(color)) {
    return color.startsWith('#') ? color : `#${color}`;
  }
  
  return defaultColor;
}

function minifySVG(svg: string): string {
  return svg.replace(/\s+/g, ' ').replace(/>\s+</g, '><').trim();
}

function checkRateLimit(ip: string): boolean {
  const now = Date.now();
  const record = requestCounts.get(ip);
  
  if (!record || now > record.resetAt) {
    requestCounts.set(ip, { count: 1, resetAt: now + RATE_LIMIT_WINDOW });
    return true;
  }
  
  if (record.count >= RATE_LIMIT_MAX) return false;
  record.count++;
  return true;
}

async function fetchWithCache(key: string, fetcher: () => Promise<any>) {
  const cached = cache.get(key);
  if (cached && cached.expires > Date.now()) {
    return cached.data;
  }
  const data = await fetcher();
  cache.set(key, { data, expires: Date.now() + CACHE_TTL });
  return data;
}

async function githubFetch(endpoint: string): Promise<any> {
  const headers: Record<string, string> = {
    'Accept': 'application/vnd.github.v3+json',
    'User-Agent': 'snd-stats-api'
  };
  if (GITHUB_TOKEN) headers['Authorization'] = `token ${GITHUB_TOKEN}`;
  
  const res = await fetch(`https://api.github.com${endpoint}`, { headers });
  if (!res.ok) throw new Error(`GitHub API error: ${res.status}`);
  return res.json();
}

async function fetchTwitterStats(username: string) {
  if (!TWITTER_BEARER) return null;
  
  return fetchWithCache(`twitter:${username}`, async () => {
    const res = await fetch(
      `https://api.twitter.com/2/users/by/username/${username}?user.fields=public_metrics`,
      { headers: { 'Authorization': `Bearer ${TWITTER_BEARER}` } }
    );
    
    if (!res.ok) return null;
    const data: any = await res.json();
    
    return {
      username: data.data.username,
      followers: data.data.public_metrics.followers_count,
      following: data.data.public_metrics.following_count,
      tweets: data.data.public_metrics.tweet_count
    };
  });
}

async function fetchYouTubeStats(channelId: string) {
  if (!YOUTUBE_API_KEY) return null;
  
  return fetchWithCache(`youtube:${channelId}`, async () => {
    const res = await fetch(
      `https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${channelId}&key=${YOUTUBE_API_KEY}`
    );
    
    if (!res.ok) return null;
    const data: any = await res.json();
    
    if (!data.items || data.items.length === 0) return null;
    
    const stats = data.items[0].statistics;
    return {
      subscribers: parseInt(stats.subscriberCount),
      views: parseInt(stats.viewCount),
      videos: parseInt(stats.videoCount)
    };
  });
}

async function getUserStats(username: string) {
  return fetchWithCache(`user:${username}`, async () => {
    const [user, repos] = await Promise.all([
      githubFetch(`/users/${username}`),
      githubFetch(`/users/${username}/repos?per_page=100&sort=updated`)
    ]);
    
  
    const ownRepos = repos.filter((r: any) => !r.fork);
    const totalStars = ownRepos.reduce((sum: number, r: any) => sum + r.stargazers_count, 0);
    const languages: Record<string, number> = {};
    const frameworks: Record<string, number> = {};
    
    for (const repo of repos) {
      if (repo.language) {
        languages[repo.language] = (languages[repo.language] || 0) + 1;
      }
      
      if (repo.topics) {
        for (const topic of repo.topics) {
          const framework = Object.keys(frameworkIcons).find(f => 
            f.toLowerCase() === topic.toLowerCase()
          );
          if (framework) {
            frameworks[framework] = (frameworks[framework] || 0) + 1;
          }
        }
      }
    }
    
    const topLang = Object.entries(languages).sort((a, b) => b[1] - a[1])[0]?.[0] || 'Unknown';
    const topFrameworks = Object.entries(frameworks)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 3)
      .map(([name]) => name);
    
    return {
      username: user.login,
      name: user.name || user.login,
      avatar: user.avatar_url,
      repos: user.public_repos,
      followers: user.followers,
      following: user.following,
      totalStars,
      topLanguage: topLang,
      languages: Object.entries(languages)
        .sort((a, b) => b[1] - a[1])
        .map(([name, count]) => ({ name, count })),
      frameworks: topFrameworks,
      createdAt: user.created_at
    };
  });
}

async function getRepoStats(owner: string, repo: string) {
  return fetchWithCache(`repo:${owner}/${repo}`, async () => {
    const [repoData, commits] = await Promise.all([
      githubFetch(`/repos/${owner}/${repo}`),
      githubFetch(`/repos/${owner}/${repo}/commits?per_page=30`).catch(() => [])
    ]);
    
    const frameworks: string[] = [];
    if (repoData.topics) {
      for (const topic of repoData.topics) {
        const framework = Object.keys(frameworkIcons).find(f => 
          f.toLowerCase() === topic.toLowerCase()
        );
        if (framework && !frameworks.includes(framework)) {
          frameworks.push(framework);
        }
      }
    }
    
    return {
      owner: repoData.owner.login,
      name: repoData.name,
      fullName: repoData.full_name,
      description: repoData.description,
      stars: repoData.stargazers_count,
      forks: repoData.forks_count,
      watchers: repoData.watchers_count,
      language: repoData.language || 'Unknown',
      openIssues: repoData.open_issues_count,
      commits: commits.length,
      updatedAt: repoData.updated_at,
      frameworks: frameworks.slice(0, 3),
      topics: repoData.topics || []
    };
  });
}

function generateSparkline(values: number[], width: number, height: number): string {
  if (values.length < 2) return '';
  const max = Math.max(...values, 1);
  const step = width / (values.length - 1);
  
  let path = '';
  values.forEach((val, i) => {
    const x = i * step + (Math.random() - 0.5) * 2;
    const y = height - (val / max) * height + (Math.random() - 0.5) * 3;
    path += i === 0 ? `M${x},${y}` : ` L${x},${y}`;
  });
  
  return path;
}

function generateSmoothLine(values: number[], width: number, height: number): string {
  if (values.length < 2) return '';
  const max = Math.max(...values, 1);
  const step = width / (values.length - 1);
  
  let path = '';
  const points = values.map((val, i) => ({
    x: i * step,
    y: height - (val / max) * height
  }));
  
  path = `M${points[0].x},${points[0].y}`;
  
  for (let i = 1; i < points.length; i++) {
    const xc = (points[i].x + points[i - 1].x) / 2;
    const yc = (points[i].y + points[i - 1].y) / 2;
    path += ` Q${points[i - 1].x},${points[i - 1].y} ${xc},${yc}`;
  }
  
  path += ` T${points[points.length - 1].x},${points[points.length - 1].y}`;
  return path;
}

function generateBarChart(values: number[], width: number, height: number, color: string): string {
  if (values.length === 0) return '';
  const max = Math.max(...values, 1);
  const barWidth = (width / values.length) * 0.7;
  const gap = (width / values.length) * 0.3;
  
  return values.map((val, i) => {
    const barHeight = (val / max) * height;
    const x = i * (barWidth + gap);
    const y = height - barHeight;
    return `<rect x="${x}" y="${y}" width="${barWidth}" height="${barHeight}" fill="${color}" rx="2"/>`;
  }).join('');
}
function generateAreaChart(values: number[], width: number, height: number, color: string): string {
  if (values.length < 2) return '';
  const max = Math.max(...values, 1);
  const step = width / (values.length - 1);
  
  let path = `M0,${height}`;
  values.forEach((val, i) => {
    const x = i * step;
    const y = height - (val / max) * height;
    path += ` L${x},${y}`;
  });
  path += ` L${width},${height} Z`;
  
  return `<path d="${path}" fill="${color}" opacity="0.3"/><path d="${generateSmoothLine(values, width, height)}" fill="none" stroke="${color}" stroke-width="2"/>`;
}

function generateWatermark(x: number, y: number, color: string = '#999'): string {
  return `<text x="${x}" y="${y}" font-family="Segoe UI,sans-serif" font-size="9" fill="${color}" opacity="0.5" transform="rotate(-2 ${x} ${y})">github.com/mytai20100/snd-stats</text>`;
}

function getIcon(name: string, x: number, y: number, type: 'language' | 'framework' | 'os' | 'custom' | 'social' = 'language'): string {
  let iconMap = languageIcons;
  if (type === 'framework') iconMap = frameworkIcons;
  if (type === 'os') iconMap = osIcons;
  if (type === 'custom') iconMap = customIcons;
  if (type === 'social') iconMap = socialIcons;
  
  const icon = iconMap[name] || '<circle cx="12" cy="12" r="8" fill="#888"/>';
  return `<g transform="translate(${x},${y}) scale(0.8)">${icon}</g>`;
}

function generateHandDrawnChart(
  data: number[],
  width: number,
  height: number,
  color: string,
  label: string,
  showValues: boolean = false
): string {
  const sparkline = generateSparkline(data, width - 20, height - 40);
  const max = Math.max(...data, 1);
  const current = data[data.length - 1];
  
  return `
    <g>
      <text x="10" y="20" font-family="Segoe UI,sans-serif" font-size="12" fill="${color}" font-weight="600">${label}</text>
      ${showValues ? `<text x="${width - 10}" y="20" font-family="Segoe UI,sans-serif" font-size="12" fill="${color}" font-weight="600" text-anchor="end">${current}</text>` : ''}
      <path d="${sparkline}" fill="none" stroke="${color}" stroke-width="2" stroke-dasharray="3,2" transform="translate(10,30)" stroke-linecap="round"/>
      // <circle cx="${width - 10}" cy="${height - 20}" r="3" fill="${color}">
      //   <animate attributeName="r" values="3;5;3" dur="1.5s" repeatCount="indefinite"/>
      // </circle>
    </g>
  `;
}

function generateAdvancedChart(
  data: number[],
  width: number,
  height: number,
  color: string,
  label: string,
  chartType: string = 'line',
  showValues: boolean = false
): string {
  const max = Math.max(...data, 1);
  const current = data[data.length - 1];
  let chartSVG = '';
  
  switch (chartType) {
    case 'bar':
      chartSVG = generateBarChart(data, width - 20, height - 40, color);
      break;
    case 'area':
      chartSVG = generateAreaChart(data, width - 20, height - 40, color);
      break;
    case 'smooth':
      chartSVG = `<path d="${generateSmoothLine(data, width - 20, height - 40)}" fill="none" stroke="${color}" stroke-width="2.5" stroke-linecap="round"/>`;
      break;
    default:
      chartSVG = `<path d="${generateSparkline(data, width - 20, height - 40)}" fill="none" stroke="${color}" stroke-width="2" stroke-dasharray="3,2" stroke-linecap="round"/>`;
  }
  
  return `
    <g>
      <text x="10" y="20" font-family="Segoe UI,sans-serif" font-size="12" fill="${color}" font-weight="600">${label}</text>
      ${showValues ? `<text x="${width - 10}" y="20" font-family="Segoe UI,sans-serif" font-size="14" fill="${color}" font-weight="700" text-anchor="end">${current.toLocaleString()}</text>` : ''}
      <g transform="translate(10,30)">${chartSVG}</g>
      ${chartType !== 'bar' ? `<circle cx="${width - 10}" cy="${height - 20}" r="3" fill="${color}">
        <animate attributeName="r" values="3;5;3" dur="1.5s" repeatCount="indefinite"/>
      </circle>` : ''}
    </g>
  `;
}

function generateUserCard(stats: any, options: BadgeOptions = {}): string {
  const width = parseInt(options.width || '495');
  const height = parseInt(options.height || '250');
  const bgColor = parseColor(options.bg_color, '#ffffff');
  const textColor = parseColor(options.text_color, '#333333');
  const accentColor = parseColor(options.accent_color, '#2f80ed');
  const showFrameworks = options.show_frameworks !== 'false';
  const chartType = options.chart_type || 'line';
  const topLangs = parseInt(options.top_langs || '5');
  const fontSize = parseInt(options.font_size || '14');
  const showValues = options.show_values !== 'false';
  
  const followerData = Array.from({ length: 10 }, () => Math.floor(Math.random() * 20) + stats.followers / 10);
  const topLanguages = stats.languages.slice(0, topLangs);
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
    <defs>
    <style>
    @keyframes fadeIn { to { opacity: 1; } }
    @keyframes slideIn { to { transform: translateX(0); opacity: 1; } }
     </style>
      </defs>
      <style>
        .title { font: 600 20px Segoe UI,sans-serif; fill: ${accentColor}; }
        .stat { font: 400 ${fontSize}px Segoe UI,sans-serif; fill: ${textColor}; }
        .value { font: 600 ${fontSize + 2}px Segoe UI,sans-serif; fill: ${accentColor}; }
        .lang { font: 400 12px Segoe UI,sans-serif; fill: ${textColor}; opacity: 0.8; }
      </style>
    </defs>
    <rect width="${width}" height="${height}" fill="${bgColor}" stroke="${accentColor}" stroke-width="2" rx="8"/>
    
    <text x="20" y="35" class="title">${stats.name}'s GitHub Stats</text>
    
    <g transform="translate(20, 60)">
      <text y="0" class="stat"> Total Stars: <tspan class="value">${stats.totalStars.toLocaleString()}</tspan></text>
      <text y="25" class="stat"> Repos: <tspan class="value">${stats.repos}</tspan></text>
      <text y="50" class="stat"> Followers: <tspan class="value">${stats.followers.toLocaleString()}</tspan></text>
      <text y="75" class="stat"> Following: <tspan class="value">${stats.following.toLocaleString()}</tspan></text>
    </g>
    
    <g transform="translate(250, 60)">
      ${generateAdvancedChart(followerData, 220, 100, accentColor, 'Activity', chartType, showValues)}
    </g>
    
    <g transform="translate(20, 155)">
      <text y="0" class="lang">Top ${topLangs} Languages:</text>
      ${topLanguages.map((lang: any, i: number) => getIcon(lang.name, i * 30, 10, 'language')).join('')}
      <text x="${Math.min(topLangs, topLanguages.length) * 30 + 10}" y="25" class="lang">${topLanguages.map((l: any) => l.name).join(', ')}</text>
    </g>
    
    ${showFrameworks && stats.frameworks.length > 0 ? `
      <g transform="translate(20, 195)">
        <text y="0" class="lang">Frameworks:</text>
        ${stats.frameworks.map((fw: string, i: number) => getIcon(fw, i * 30, 10, 'framework')).join('')}
        <text x="${stats.frameworks.length * 30 + 10}" y="25" class="lang">${stats.frameworks.join(', ')}</text>
      </g>
    ` : ''}
    
    ${generateWatermark(width - 180, height - 10, textColor)}
  </svg>`);
}

function generateRepoCard(stats: any, options: BadgeOptions = {}): string {
  const width = parseInt(options.width || '495');
  const height = parseInt(options.height || '280');
  const bgColor = parseColor(options.bg_color, '#ffffff');
  const textColor = parseColor(options.text_color, '#333333');
  const accentColor = parseColor(options.accent_color, '#2f80ed');
  const showChart = options.show_chart !== 'false';
  const showFrameworks = options.show_frameworks !== 'false';
  const chartType = options.chart_type || 'line';
  const fontSize = parseInt(options.font_size || '14');
  const showValues = options.show_values !== 'false';
  
  const commitData = Array.from({ length: 15 }, () => Math.floor(Math.random() * 25) + 5);
  const starsData = Array.from({ length: 15 }, () => Math.floor(Math.random() * 20) + stats.stars / 10);
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <style>
        .title { font: 700 18px Segoe UI,sans-serif; fill: ${accentColor}; }
        .desc { font: 400 12px Segoe UI,sans-serif; fill: ${textColor}; opacity: 0.7; }
        .stat { font: 400 ${fontSize}px Segoe UI,sans-serif; fill: ${textColor}; }
        .value { font: 700 ${fontSize + 2}px Segoe UI,sans-serif; fill: ${accentColor}; }
      </style>
    </defs>
    <rect width="${width}" height="${height}" fill="${bgColor}" stroke="${accentColor}" stroke-width="2" rx="10"/>
    
    <text x="20" y="35" class="title">${stats.fullName}</text>
    <text x="20" y="55" class="desc">${(stats.description || 'No description').substring(0, 65)}...</text>
    
    <g transform="translate(20, 85)">
      <text y="0" class="stat"> Stars: <tspan class="value">${stats.stars.toLocaleString()}</tspan></text>
      <text x="150" y="0" class="stat"> Forks: <tspan class="value">${stats.forks.toLocaleString()}</tspan></text>
      <text y="25" class="stat"> Watchers: <tspan class="value">${stats.watchers.toLocaleString()}</tspan></text>
      <text x="150" y="25" class="stat"> Issues: <tspan class="value">${stats.openIssues}</tspan></text>
    </g>
    
    <g transform="translate(20, 140)">
      ${getIcon(stats.language, 0, 0, 'language')}
      <text x="30" y="15" class="stat">${stats.language}</text>
      
      ${showFrameworks && stats.frameworks.length > 0 ? `
        <text x="120" y="15" class="desc">Frameworks:</text>
        ${stats.frameworks.map((fw: string, i: number) => getIcon(fw, 200 + i * 30, 0, 'framework')).join('')}
      ` : ''}
    </g>
    
    ${showChart ? `
      <g transform="translate(20, 175)">
        ${generateAdvancedChart(commitData, 220, 80, accentColor, 'Commits', chartType, showValues)}
      </g>
      <g transform="translate(250, 175)">
        ${generateAdvancedChart(starsData, 220, 80, '#f39c12', 'Stars', chartType, showValues)}
      </g>
    ` : ''}
    
    ${generateWatermark(width - 180, height - 10, textColor)}
  </svg>`);
}

function generateStaticBadge(label: string, value: string, options: BadgeOptions = {}): string {
  const width = parseInt(options.width || '200');
  const height = parseInt(options.height || '35');
  const labelColor = parseColor(options.label_color, '#555555');
  const valueColor = parseColor(options.value_color, '#2f80ed');
  const fontSize = parseInt(options.font_size || '12');
  const borderRadius = parseInt(options.border_radius || '4');
  const labelWidth = Math.floor(width * 0.4);
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <style>
        .label { font: 600 ${fontSize}px Segoe UI,sans-serif; fill: #fff; }
        .value { font: 600 ${fontSize}px Segoe UI,sans-serif; fill: #fff; }
      </style>
    </defs>
    <rect width="${labelWidth}" height="${height}" fill="${labelColor}" rx="${borderRadius}"/>
    <rect x="${labelWidth}" width="${width - labelWidth}" height="${height}" fill="${valueColor}" rx="${borderRadius}"/>
    <text x="${labelWidth / 2}" y="${height / 2 + 4}" text-anchor="middle" class="label">${label}</text>
    <text x="${labelWidth + (width - labelWidth) / 2}" y="${height / 2 + 4}" text-anchor="middle" class="value">${value}</text>
  </svg>`);
}

function generateRankBadge(rank: number, options: BadgeOptions = {}): string {
  const width = parseInt(options.width || '140');
  const height = parseInt(options.height || '40');
  const bgColor = parseColor(options.bg_color, '#f39c12');
  const textColor = parseColor(options.text_color, '#ffffff');
  const fontSize = parseInt(options.font_size || '18');
  const borderRadius = parseInt(options.border_radius || '6');
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <style>
        .rank { font: 700 ${fontSize}px Segoe UI,sans-serif; fill: ${textColor}; }
      </style>
    </defs>
    <rect width="${width}" height="${height}" fill="${bgColor}" rx="${borderRadius}" stroke="#e67e22" stroke-width="2"/>
    <text x="${width / 2}" y="${height / 2 + 6}" text-anchor="middle" class="rank"> Rank ${rank}</text>
  </svg>`);
}

function generateSocialBadge(platform: string, stats: any, options: BadgeOptions = {}): string {
  const width = parseInt(options.width || '300');
  const height = parseInt(options.height || '120');
  const bgColor = parseColor(options.bg_color, '#ffffff');
  const accentColor = parseColor(options.accent_color, '#1DA1F2');
  const fontSize = parseInt(options.font_size || '14');
  
  let content = '';
  
  if (platform === 'twitter' && stats) {
    content = `<text x="20" y="35" class="title">@${stats.username} on X/Twitter</text>
      <text x="20" y="60" class="stat"> Followers: <tspan class="value">${stats.followers.toLocaleString()}</tspan></text>
      <text x="20" y="85" class="stat"> Tweets: <tspan class="value">${stats.tweets.toLocaleString()}</tspan></text>`;
  } else if (platform === 'youtube' && stats) {
    content = `<text x="20" y="35" class="title">YouTube Channel</text>
      <text x="20" y="60" class="stat"> Subscribers: <tspan class="value">${stats.subscribers.toLocaleString()}</tspan></text>
      <text x="20" y="85" class="stat"> Views: <tspan class="value">${stats.views.toLocaleString()}</tspan></text>`;
  }
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <style>
        .title { font: 600 16px Segoe UI,sans-serif; fill: ${accentColor}; }
        .stat { font: 400 ${fontSize}px Segoe UI,sans-serif; fill: #333; }
        .value { font: 600 ${fontSize}px Segoe UI,sans-serif; fill: ${accentColor}; }
      </style>
    </defs>
    <rect width="${width}" height="${height}" fill="${bgColor}" stroke="${accentColor}" stroke-width="2" rx="6"/>
    ${content}
    ${generateWatermark(width - 180, height - 10)}
  </svg>`);
}

function generateOSBadge(os: string, options: BadgeOptions = {}): string {
  const width = parseInt(options.width || '150');
  const height = parseInt(options.height || '50');
  const bgColor = parseColor(options.bg_color, '#ffffff');
  const textColor = parseColor(options.text_color, '#333333');
  const fontSize = parseInt(options.font_size || '14');
  const borderRadius = parseInt(options.border_radius || '6');
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <style>
        .os-text { font: 600 ${fontSize}px Segoe UI,sans-serif; fill: ${textColor}; }
      </style>
    </defs>
    <rect width="${width}" height="${height}" fill="${bgColor}" stroke="#ddd" stroke-width="2" rx="${borderRadius}"/>
    ${getIcon(os, 15, 10, 'os')}
    <text x="45" y="${height / 2 + 5}" class="os-text">${os}</text>
  </svg>`);
}

function generateCustomBadge(options: CustomBadgeOptions): string {
  const width = parseInt(options.width || '250');
  const height = parseInt(options.height || '80');
  const bgColor = parseColor(options.bg_color, '#ffffff');
  const textColor = parseColor(options.text_color, '#333333');
  const accentColor = parseColor(options.accent_color, '#2f80ed');
  const iconColor = parseColor(options.icon_color, accentColor);
  const fontSize = parseInt(options.font_size || '14');
  const borderRadius = parseInt(options.border_radius || '8');
  const animation = options.animation || 'none';
  
  const label = options.label || 'Label';
  const value = options.value || 'Value';
  const icon = options.icon || 'star';
  
  let animationSVG = '';
  if (animation === 'pulse') {
    animationSVG = `<animate attributeName="opacity" values="1;0.6;1" dur="2s" repeatCount="indefinite"/>`;
  } else if (animation === 'bounce') {
    animationSVG = `<animateTransform attributeName="transform" type="translate" values="0,0; 0,-5; 0,0" dur="1s" repeatCount="indefinite"/>`;
  } else if (animation === 'glow') {
    animationSVG = `<animate attributeName="stroke-width" values="2;4;2" dur="2s" repeatCount="indefinite"/>`;
  }
  
  return minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <style>
        .label-text { font: 600 ${fontSize}px Segoe UI,sans-serif; fill: ${textColor}; }
        .value-text { font: 700 ${fontSize + 4}px Segoe UI,sans-serif; fill: ${accentColor}; }
      </style>
      <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:${bgColor};stop-opacity:1" />
        <stop offset="100%" style="stop-color:${accentColor};stop-opacity:0.1" />
      </linearGradient>
    </defs>
    <rect width="${width}" height="${height}" fill="url(#grad)" stroke="${accentColor}" stroke-width="2" rx="${borderRadius}">
      ${animation === 'glow' ? animationSVG : ''}
    </rect>
    <g transform="translate(15, ${height / 2 - 12})">
      <g fill="${iconColor}">
        ${getIcon(icon, 0, 0, 'custom')}
        ${animation === 'bounce' ? animationSVG : ''}
      </g>
    </g>
    <g transform="translate(45, ${height / 2 - 10})">
      <text y="0" class="label-text">${label}</text>
      <text y="20" class="value-text">
        ${value}
        ${animation === 'pulse' ? animationSVG : ''}
      </text>
    </g>
    ${generateWatermark(width - 180, height - 10, textColor)}
  </svg>`);
}

function generateIconBadge(icon: string, options: BadgeOptions = {}): string {
  const size = parseInt(options.width || '40');
  const bgColor = parseColor(options.bg_color, '#ffffff');
  const iconColor = parseColor(options.accent_color, '#2f80ed');
  
  return minifySVG(`<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg">
    <rect width="${size}" height="${size}" fill="${bgColor}" rx="${size / 4}"/>
    <g transform="translate(${size / 4}, ${size / 4})" fill="${iconColor}">
      ${getIcon(icon, 0, 0, 'custom')}
    </g>
  </svg>`);
}

// Middleware
app.use((req: Request, res: Response, next: NextFunction) => {
  res.setHeader('Access-Control-Allow-Origin', '*');
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, X-API-Key');
  
  if (req.method === 'OPTIONS') {
    return res.sendStatus(200);
  }
  
  next();
});

app.use((req: Request, res: Response, next: NextFunction) => {
  const ip = req.ip || req.socket.remoteAddress || 'unknown';
  
  if (!checkRateLimit(ip)) {
    return res.status(429).json({ 
      error: 'Rate limit exceeded',
      message: 'Too many requests. Please try again later.'
    });
  }
  
  next();
});

// Routes
app.get('/health', (req: Request, res: Response) => {
  res.json({ 
    status: 'ok', 
    timestamp: Date.now(), 
    version: '2.1.0',
    cache_size: cache.size,
    uptime: process.uptime()
  });
});

app.get('/stats/user/:username', async (req: Request, res: Response) => {
  try {
    const { username } = req.params;
    const format = req.query.format || 'svg';
    const stats = await getUserStats(username);

    if (format === 'json') {
      res.json(stats);
    } else {
      res.setHeader('Content-Type', 'image/svg+xml');
      res.setHeader('Cache-Control', 'public, max-age=1800');
      res.send(generateUserCard(stats, req.query as BadgeOptions));
    }
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/stats/repo/:owner/:repo', async (req: Request, res: Response) => {
  try {
    const { owner, repo } = req.params;
    const format = req.query.format || 'svg';
    const stats = await getRepoStats(owner, repo);

    if (format === 'json') {
      res.json(stats);
    } else {
      res.setHeader('Content-Type', 'image/svg+xml');
      res.setHeader('Cache-Control', 'public, max-age=1800');
      res.send(generateRepoCard(stats, req.query as BadgeOptions));
    }
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/badge/custom', (req: Request, res: Response) => {
  try {
    res.setHeader('Content-Type', 'image/svg+xml');
    res.setHeader('Cache-Control', 'public, max-age=3600');
    res.send(generateCustomBadge(req.query as CustomBadgeOptions));
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/badge/:type', async (req: Request, res: Response) => {
  try {
    const { type } = req.params;
    const { owner, repo, user } = req.query;
    
    res.setHeader('Content-Type', 'image/svg+xml');
    res.setHeader('Cache-Control', 'public, max-age=1800');

    if (type === 'flex') {
      if (repo && owner) {
        const stats = await getRepoStats(owner as string, repo as string);
        res.send(generateRepoCard(stats, req.query as BadgeOptions));
      } else if (user) {
        const stats = await getUserStats(user as string);
        res.send(generateUserCard(stats, req.query as BadgeOptions));
      } else {
        res.status(400).send('Missing parameters');
      }
    } else if (type === 'static') {
      if (repo && owner) {
        const stats = await getRepoStats(owner as string, repo as string);
        res.send(generateStaticBadge(stats.language, ` ${stats.stars.toLocaleString()}`, req.query as BadgeOptions));
      } else {
        res.status(400).send('Missing parameters');
      }
    } else if (type === 'rank') {
      const list = (req.query.list as string || '').split(',');
      const currentRepo = `${owner}/${repo}`;
      
      const repoStars = await Promise.all(
        list.map(async (r) => {
          const [o, rp] = r.split('/');
          if (!o || !rp) return { repo: r, stars: 0 };
          try {
            const stats = await getRepoStats(o, rp);
            return { repo: r, stars: stats.stars };
          } catch {
            return { repo: r, stars: 0 };
          }
        })
      );
      
      repoStars.sort((a, b) => b.stars - a.stars);
      const rank = repoStars.findIndex(r => r.repo === currentRepo) + 1;
      
      res.send(generateRankBadge(rank || 999, req.query as BadgeOptions));
    } else {
      res.status(400).send('Invalid badge type');
    }
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/social/:platform/:identifier', async (req: Request, res: Response) => {
  try {
    const { platform, identifier } = req.params;
    const format = req.query.format || 'svg';
    let stats = null;

    if (platform === 'twitter' || platform === 'x') {
      stats = await fetchTwitterStats(identifier);
    } else if (platform === 'youtube') {
      stats = await fetchYouTubeStats(identifier);
    }

    if (!stats) {
      return res.status(404).json({ error: 'Stats not found or API not configured' });
    }

    if (format === 'json') {
      res.json(stats);
    } else {
      res.setHeader('Content-Type', 'image/svg+xml');
      res.setHeader('Cache-Control', 'public, max-age=1800');
      res.send(generateSocialBadge(platform, stats, req.query as BadgeOptions));
    }
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/os/:osname', (req: Request, res: Response) => {
  try {
    const { osname } = req.params;
    res.setHeader('Content-Type', 'image/svg+xml');
    res.setHeader('Cache-Control', 'public, max-age=3600');
    res.send(generateOSBadge(osname, req.query as BadgeOptions));
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/framework/:name', (req: Request, res: Response) => {
  try {
    const { name } = req.params;
    const width = parseInt(req.query.width as string) || 150;
    const height = parseInt(req.query.height as string) || 50;
    const bgColor = parseColor(req.query.bg_color as string, '#ffffff');
    const textColor = parseColor(req.query.text_color as string, '#333333');
    const fontSize = parseInt(req.query.font_size as string) || 14;
    const borderRadius = parseInt(req.query.border_radius as string) || 6;
    
    res.setHeader('Content-Type', 'image/svg+xml');
    res.setHeader('Cache-Control', 'public, max-age=3600');

    const svg = minifySVG(`<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <style>
          .fw-text { font: 600 ${fontSize}px Segoe UI,sans-serif; fill: ${textColor}; }
        </style>
      </defs>
      <rect width="${width}" height="${height}" fill="${bgColor}" stroke="#ddd" stroke-width="2" rx="${borderRadius}"/>
      ${getIcon(name, 15, 10, 'framework')}
      <text x="45" y="${height / 2 + 5}" class="fw-text">${name}</text>
    </svg>`);

    res.send(svg);
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/rank/repo', async (req: Request, res: Response) => {
  try {
    const { owner, repo, list } = req.query;
    if (!owner || !repo || !list) {
      return res.status(400).json({ error: 'Missing required parameters' });
    }

    const repos = (list as string).split(',');
    const currentRepo = `${owner}/${repo}`;

    const repoStars = await Promise.all(
      repos.map(async (r) => {
        const [o, rp] = r.split('/');
        if (!o || !rp) return { repo: r, stars: 0 };
        try {
          const stats = await getRepoStats(o, rp);
          return { repo: r, stars: stats.stars };
        } catch {
          return { repo: r, stars: 0 };
        }
      })
    );

    repoStars.sort((a, b) => b.stars - a.stars);
    const rank = repoStars.findIndex(r => r.repo === currentRepo) + 1;

    res.json({ 
      repo: currentRepo, 
      rank: rank || 'unranked', 
      total: repos.length, 
      leaderboard: repoStars 
    });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/discord/update', (req: Request, res: Response) => {
  const apiKey = req.headers['x-api-key'];
  if (apiKey !== API_KEY) {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  const { serverId, serverName, members } = req.body;
  if (!serverId || !serverName || typeof members !== 'number') {
    return res.status(400).json({ error: 'Invalid payload' });
  }

  discordServers.set(serverId, { serverName, members });
  res.json({
    success: true,
    serverId,
    badgeUrl: `/discord/badge/${serverId}`
  });
});

app.get('/discord/badge/:serverId', (req: Request, res: Response) => {
  const { serverId } = req.params;
  const server = discordServers.get(serverId);
  
  if (!server) {
    return res.status(404).send('Server not found');
  }

  res.setHeader('Content-Type', 'image/svg+xml');
  res.setHeader('Cache-Control', 'public, max-age=300');
  res.send(generateStaticBadge(server.serverName, `${server.members} members`, req.query as BadgeOptions));
});

app.get('/icons/list', (req: Request, res: Response) => {
  res.json({
    languages: Object.keys(languageIcons),
    frameworks: Object.keys(frameworkIcons),
    os: Object.keys(osIcons),
    custom: Object.keys(customIcons),
    social: Object.keys(socialIcons)
  });
});
app.get('/icon/:name', (req: Request, res: Response) => {
  res.setHeader('Content-Type', 'image/svg+xml');
  res.send(generateIconBadge(req.params.name, req.query as BadgeOptions));
});
// Error handling
app.use((err: Error, req: Request, res: Response, next: NextFunction) => {
  console.error(`[ERROR] ${err.message}`);
  res.status(500).json({ 
    error: 'Internal server error',
    message: process.env.NODE_ENV === 'development' ? err.message : undefined
  });
});

// Cache cleanup
setInterval(() => {
  const now = Date.now();
  for (const [key, value] of cache.entries()) {
    if (value.expires < now) cache.delete(key);
  }
}, CACHE_TTL);
app.get('/icon/social/:name', (req: Request, res: Response) => {
  const { name } = req.params;
  const size = parseInt(req.query.size as string) || 40;
  const color = parseColor(req.query.color as string, '#333');
  
  res.setHeader('Content-Type', 'image/svg+xml');
  res.setHeader('Cache-Control', 'public, max-age=86400');
  
  const svg = minifySVG(`<svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <g fill="${color}">
      ${socialIcons[name] || '<circle cx="12" cy="12" r="10" fill="#888"/>'}
    </g>
  </svg>`);
  
  res.send(svg);
});
// Start server
app.listen(PORT, () => {
  console.log(`\n Snd-stats API v0.1beta running on port ${PORT}`);
  console.log(`Endpoints: /stats, /badge, /social, /os, /framework, /badge/custom`);
  console.log(`Cache TTL: ${CACHE_TTL / 1000}s`);
  
  if (!GITHUB_TOKEN) {
    console.warn('Warning: GITHUB_TOKEN not set. Rate limits may apply.');
  }
  if (!TWITTER_BEARER) {
    console.log('Twitter/X api disabled (no token)');
  }
  if (!YOUTUBE_API_KEY) {
    console.log('YouTube api disabled (no API key)');
  }
  
  console.log('\n Serve snd-stats running!\n');
});
